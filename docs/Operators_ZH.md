# 算子提要

算子 (Operator) 是协助数据修改、清理、过滤、去重等基本流程的集合。我们支持广泛的数据来源和文件格式，并支持对自定义数据集的灵活扩展。

这个页面提供了OP的基本描述，用户可以参考[API文档](https://modelscope.github.io/data-juicer/)更细致了解每个OP的具体参数，并且可以查看、运行单元测试 (`tests/ops/...`)，来体验[各OP的用法示例](../tests/ops)以及每个OP作用于内置测试数据样本时的效果。

## 概览

Data-Juicer 中的算子分为以下 5 种类型。

| 类型                                | 数量 | 描述            |
|------------------------------------|:--:|---------------|
| [ Formatter ]( #formatter )        |  9 | 发现、加载、规范化原始数据 |
| [ Mapper ]( #mapper )              | 63 | 对数据样本进行编辑和转换  |
| [ Filter ]( #filter )              | 44 | 过滤低质量样本       |
| [ Deduplicator ]( #deduplicator )  |  8 | 识别、删除重复样本     |
| [ Selector ]( #selector )          |  4 | 基于排序选取高质量样本   |
| [ Grouper ]( #grouper )           |   2    | 将样本分组，每一组组成一个批量样本                |
| [ Aggregator ]( #aggregator )     |   3    | 对批量样本进行汇总，如得出总结或结论 |

下面列出所有具体算子，每种算子都通过多个标签来注明其主要功能。

* 领域标签
    - ![General](https://img.shields.io/badge/General-5FBF50?style=plastic): 一般用途
    - ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic): 专用于 LaTeX 源文件
    - ![Code](https://img.shields.io/badge/Code-590F08?style=plastic): 专用于编程代码
    - ![Financial](https://img.shields.io/badge/Financial-A64C44?style=plastic): 与金融领域相关
* 模态标签
    - ![Text](https://img.shields.io/badge/Text-010326?style=plastic): 专用于文本
    - ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic): 专用于图像
    - ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic): 专用于音频
    - ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic): 专用于视频
    - ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic): 专用于多模态
* 语言标签
    - ![en](https://img.shields.io/badge/en-A60D1A?style=plastic): 英文
    - ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic): 中文
* 资源标签
    - ![CPU](https://img.shields.io/badge/CPU-F2AA6B?style=plastic): 只需要 CPU 资源 (默认)
    - ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic): 额外需要 GPU/CUDA 资源


## Formatter <a name="formatter"/>

| 算子              | 标签                                                                                                                                                                                          | 描述                                                                                     | 源码                                               | 单测样例                                           |
|-------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------------------------------------------|----------------------------------------------------|
| local_formatter   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 从本地文件准备数据集                                                                     | [code](../data_juicer/format/formatter.py)         | [tests](../tests/format/test_unify_format.py)      |
| remote_formatter  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备远端数据集 (如 HuggingFace)                                                          | [code](../data_juicer/format/formatter.py)         | [tests](../tests/format/test_unify_format.py)      |
| csv_formatter     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备本地 `.csv` 文件                                                                     | [code](../data_juicer/format/csv_formatter.py)     | [tests](../tests/format/test_csv_formatter.py)     |
| tsv_formatter     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备本地 `.tsv` 文件                                                                     | [code](../data_juicer/format/tsv_formatter.py)     | [tests](../tests/format/test_tsv_formatter.py)     |
| json_formatter    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备本地 `.json`, `.jsonl`, `.jsonl.zst` 文件                                            | [code](../data_juicer/format/json_formatter.py)    | -                                                  |
| parquet_formatter | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备本地 `.parquet` 文件                                                                 | [code](../data_juicer/format/parquet_formatter.py) | [tests](../tests/format/test_parquet_formatter.py) |
| text_formatter    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 准备其他本地文本文件（[完整的支持列表](../data_juicer/format/text_formatter.py#L63,73)） | [code](../data_juicer/format/text_formatter.py)    | -                                                  |
| empty_formatter   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic)                                                                                                                         | 准备一个空数据集                                                                         | [code](../data_juicer/format/empty_formatter.py)   | [tests](../tests/format/test_empty_formatter.py)   |
| mixture_formatter | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 处理可支持本地文件的混合                                                                 | [code](../data_juicer/format/mixture_formatter.py) | [tests](../tests/format/test_mixture_formatter.py) |

## Mapper <a name="mapper"/>

| 算子                                           | 标签                                                                                                                                                                                                                                                                                                                          | 描述                                                                                                                 | 源码                                                                               | 单测样例                                                                           |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| audio_ffmpeg_wrapped_mapper                    | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                             | 运行 FFmpeg 语音过滤器的简单封装                                                                                     | [code](../data_juicer/ops/mapper/audio_ffmpeg_wrapped_mapper.py)                   | [tests](../tests/ops/mapper/test_audio_ffmpeg_wrapped_mapper.py)                   |
| calibrate_qa_mapper                            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 根据参考文本校准问答对                                                                                               | [code](../data_juicer/ops/mapper/calibrate_qa_mapper.py)                           | [tests](../tests/ops/mapper/test_calibrate_qa_mapper.py)                           |
| calibrate_query_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 根据参考文本校准问答对中的问题                                                                                       | [code](../data_juicer/ops/mapper/calibrate_query_mapper.py)                        | [tests](../tests/ops/mapper/test_calibrate_query_mapper.py)                        |
| calibrate_response_mapper                      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 根据参考文本校准问答对中的回答                                                                                       | [code](../data_juicer/ops/mapper/calibrate_response_mapper.py)                     | [tests](../tests/ops/mapper/test_calibrate_response_mapper.py)                     |
| chinese_convert_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                             | 用于在繁体中文、简体中文和日文汉字之间进行转换（借助 [opencc](https://github.com/BYVoid/OpenCC)）                    | [code](../data_juicer/ops/mapper/chinese_convert_mapper.py)                        | [tests](../tests/ops/mapper/test_chinese_convert_mapper.py)                        |
| clean_copyright_mapper                         | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                       | 删除代码文件开头的版权声明 (必须包含单词 *copyright*)                                                                | [code](../data_juicer/ops/mapper/clean_copyright_mapper.py)                        | [tests](../tests/ops/mapper/test_clean_copyright_mapper.py)                        |
| clean_email_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除邮箱信息                                                                                                         | [code](../data_juicer/ops/mapper/clean_email_mapper.py)                            | [tests](../tests/ops/mapper/test_clean_email_mapper.py)                            |
| clean_html_mapper                              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除 HTML 标签并返回所有节点的纯文本                                                                                 | [code](../data_juicer/ops/mapper/clean_html_mapper.py)                             | [tests](../tests/ops/mapper/test_clean_html_mapper.py)                             |
| clean_ip_mapper                                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除 IP 地址                                                                                                         | [code](../data_juicer/ops/mapper/clean_ip_mapper.py)                               | [tests](../tests/ops/mapper/test_clean_ip_mapper.py)                               |
| clean_links_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 删除链接，例如以 http 或 ftp 开头的                                                                                  | [code](../data_juicer/ops/mapper/clean_links_mapper.py)                            | [tests](../tests/ops/mapper/test_clean_links_mapper.py)                            |
| expand_macro_mapper                            | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 扩展通常在 TeX 文档顶部定义的宏                                                                                      | [code](../data_juicer/ops/mapper/expand_macro_mapper.py)                           | [tests](../tests/ops/mapper/test_expand_macro_mapper.py)                           |
| extract_entity_attribute_mapper                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 给定主体和属性名，从文本中抽取主体的属性                                                                                                                     | [code](../data_juicer/ops/mapper/extract_entity_attribute_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_entity_attribute_mapper.py)                           |
| extract_entity_relation_mapper                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 从文本中抽取知识图谱的实体和关系                                                                                                                    | [code](../data_juicer/ops/mapper/extract_entity_relation_mapper.py)                            | [tests](../tests/ops/mapper/test_extract_entity_relation_mapper.py)                           |
| extract_event_mapper                           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 从文本中抽取出事件和事件相关人物                                                                                                                     | [code](../data_juicer/ops/mapper/extract_event_mapper.py)                                              | [tests](../tests/ops/mapper/test_extract_event_mapper.py)                           |
| extract_keyword_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 构造文本的关键词                                                                                                                     | [code](../data_juicer/ops/mapper/extract_keyword_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_keyword_mapper.py)                           |
| extract_nickname_mapper                        | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 抽取昵称称呼关系                                                                                                                     | [code](../data_juicer/ops/mapper/extract_nickname_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_nickname_mapper.py)                           |
| extract_support_text_mapper                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 为一段总结抽取对应原文                                                                                                                    | [code](../data_juicer/ops/mapper/extract_support_text_mapper.py)                     | [tests](../tests/ops/mapper/test_extract_support_text_mapper.py)                           |
| fix_unicode_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 修复损坏的 Unicode（借助 [ftfy](https://ftfy.readthedocs.io/)）                                                      | [code](../data_juicer/ops/mapper/fix_unicode_mapper.py)                            | [tests](../tests/ops/mapper/test_fix_unicode_mapper.py)                            |
| generate_qa_from_examples_mapper               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | 根据种子数据，生成新的对话样本。                                                                                     | [code](../data_juicer/ops/mapper/generate_qa_from_examples_mapper.py)              | [tests](../tests/ops/mapper/test_generate_qa_from_examples_mapper.py)              |
| generate_qa_from_text_mapper                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | 从文本中生成问答对                                                                                                   | [code](../data_juicer/ops/mapper/generate_qa_from_text_mapper.py)                  | [tests](../tests/ops/mapper/test_generate_qa_from_text_mapper.py)                  |
| image_blur_mapper                              | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                             | 对图像进行模糊处理                                                                                                   | [code](../data_juicer/ops/mapper/image_blur_mapper.py)                             | [tests](../tests/ops/mapper/test_image_blur_mapper.py)                             |
| image_captioning_from_gpt4v_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic)                                                                                                                                                                                                                                                   | 基于gpt-4-vision和图像生成文本                                                                                       | [code](../data_juicer/ops/mapper/image_captioning_from_gpt4v_mapper.py)            | -                                                                                  |
| image_captioning_mapper                        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 生成样本，其标题是根据另一个辅助模型（例如 blip2）和原始样本中的图形生成的。                                         | [code](../data_juicer/ops/mapper/image_captioning_mapper.py)                       | [tests](../tests/ops/mapper/test_image_captioning_mapper.py)                       |
| image_diffusion_mapper                         | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 用stable diffusion生成图像，对图像进行增强                                                                           | [code](../data_juicer/ops/mapper/image_diffusion_mapper.py)                        | [tests](../tests/ops/mapper/test_image_diffusion_mapper.py)                        |
| image_face_blur_mapper                         | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                             | 对图像中的人脸进行模糊处理                                                                                           | [code](../data_juicer/ops/mapper/image_face_blur_mapper.py)                        | [tests](../tests/ops/mapper/test_image_face_blur_mapper.py)                        |
| image_tagging_mapper                           | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 从输入图片中生成图片标签                                                                                             | [code](../data_juicer/ops/mapper/image_tagging_mapper.py)                          | [tests](../tests/ops/mapper/test_image_tagging_mapper.py)                          |
| nlpaug_en_mapper                               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                                                                                             | 使用`nlpaug`库对英语文本进行简单增强                                                                                 | [code](../data_juicer/ops/mapper/nlpaug_en_mapper.py)                              | [tests](../tests/ops/mapper/test_nlpaug_en_mapper.py)                              |
| nlpcda_zh_mapper                               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                             | 使用`nlpcda`库对中文文本进行简单增强                                                                                 | [code](../data_juicer/ops/mapper/nlpcda_zh_mapper.py)                              | [tests](../tests/ops/mapper/test_nlpcda_zh_mapper.py)                              |
| optimize_qa_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | 指令优化，优化问题和答案                                                                                             | [code](../data_juicer/ops/mapper/optimize_qa_mapper.py)                            | [tests](../tests/ops/mapper/test_optimize_qa_mapper.py)                            |
| optimize_query_mapper                          | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | 指令优化，优化 query                                                                                                 | [code](../data_juicer/ops/mapper/optimize_query_mapper.py)                         | [tests](../tests/ops/mapper/test_optimize_query_mapper.py)                         |
| optimize_response_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | 指令优化，优化 response                                                                                              | [code](../data_juicer/ops/mapper/optimize_response_mapper.py)                      | [tests](../tests/ops/mapper/test_optimize_response_mapper.py)                      |
| pair_preference_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 构造配对的偏好样本                                                                                                   | [code](../data_juicer/ops/mapper/pair_preference_mapper.py)                        | [tests](../tests/ops/mapper/test_pair_preference_mapper.py)                        |
| punctuation_normalization_mapper               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 将各种 Unicode 标点符号标准化为其 ASCII 等效项                                                                       | [code](../data_juicer/ops/mapper/punctuation_normalization_mapper.py)              | [tests](../tests/ops/mapper/test_punctuation_normalization_mapper.py)              |
| python_file_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 执行文件中定义的 Python 函数处理样本                                                                                 | [code](../data_juicer/ops/mapper/python_file_mapper.py)                            | [tests](../tests/ops/mapper/test_python_file_mapper.py)                            |
| python_lambda_mapper                           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 执行 Python lambda 函数处理样本                                                                                  | [code](../data_juicer/ops/mapper/python_lambda_mapper.py)                          | [tests](../tests/ops/mapper/test_python_lambda_mapper.py)                          |
| relation_identity_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 识别一段文本中两个实体之间的关系                                                                                                                                    | [code](../data_juicer/ops/mapper/relation_identity_mapper.py)                          | [tests](../tests/ops/mapper/test_relation_identity_mapper.py)                            |
| remove_bibliography_mapper                     | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 删除 TeX 文档的参考文献                                                                                              | [code](../data_juicer/ops/mapper/remove_bibliography_mapper.py)                    | [tests](../tests/ops/mapper/test_remove_bibliography_mapper.py)                    |
| remove_comments_mapper                         | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 删除 TeX 文档中的注释                                                                                                | [code](../data_juicer/ops/mapper/remove_comments_mapper.py)                        | [tests](../tests/ops/mapper/test_remove_comments_mapper.py)                        |
| remove_header_mapper                           | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 删除 TeX 文档头，例如标题、章节数字/名称等                                                                           | [code](../data_juicer/ops/mapper/remove_header_mapper.py)                          | [tests](../tests/ops/mapper/test_remove_header_mapper.py)                          |
| remove_long_words_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除长度超出指定范围的单词                                                                                           | [code](../data_juicer/ops/mapper/remove_long_words_mapper.py)                      | [tests](../tests/ops/mapper/test_remove_long_words_mapper.py)                      |
| remove_non_chinese_character_mapper            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除样本中的非中文字符                                                                                               | [code](../data_juicer/ops/mapper/remove_non_chinese_character_mapper.py)           | [tests](../tests/ops/mapper/test_remove_non_chinese_character_mapper.py)           |
| remove_repeat_sentences_mapper                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除样本中的重复句子                                                                                                 | [code](../data_juicer/ops/mapper/remove_repeat_sentences_mapper.py)                | [tests](../tests/ops/mapper/test_remove_repeat_sentences_mapper.py)                |
| remove_specific_chars_mapper                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除任何用户指定的字符或子字符串                                                                                     | [code](../data_juicer/ops/mapper/remove_specific_chars_mapper.py)                  | [tests](../tests/ops/mapper/test_remove_specific_chars_mapper.py)                  |
| remove_table_text_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![Financial](https://img.shields.io/badge/Financial-A64C44?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                   | 检测并删除可能的表格内容（:warning: 依赖正则表达式匹配，因此很脆弱）                                                 | [code](../data_juicer/ops/mapper/remove_table_text_mapper.py)                      | [tests](../tests/ops/mapper/test_remove_table_text_mapper.py)                      |
| remove_words_with_incorrect_ substrings_mapper | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 删除包含指定子字符串的单词                                                                                           | [code](../data_juicer/ops/mapper/remove_words_with_incorrect_substrings_mapper.py) | [tests](../tests/ops/mapper/test_remove_words_with_incorrect_substrings_mapper.py) |
| replace_content_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 使用一个指定的替换字符串替换文本中满足特定正则表达式模版的所有内容                                                   | [code](../data_juicer/ops/mapper/replace_content_mapper.py)                        | [tests](../tests/ops/mapper/test_replace_content_mapper.py)                        |
| sentence_split_mapper                          | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                                                                                             | 根据语义拆分和重组句子                                                                                               | [code](../data_juicer/ops/mapper/sentence_split_mapper.py)                         | [tests](../tests/ops/mapper/test_sentence_split_mapper.py)                         |
| text_chunk_mapper                              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 对文本进行分片处理                                                                                                                  | [code](../data_juicer/ops/mapper/text_chunk_mapper.py)                           | [tests](../tests/ops/mapper/test_text_chunk_mapper.py)                           |
| video_captioning_from_audio_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 基于 Qwen-Audio 模型根据视频的音频流为视频生成新的标题描述                                                           | [code](../data_juicer/ops/mapper/video_captioning_from_audio_mapper.py)            | [tests](../tests/ops/mapper/test_video_captioning_from_audio_mapper.py)            |
| video_captioning_from_frames_mapper            | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 生成样本，其标题是基于一个文字生成图片的模型和原始样本视频中指定帧的图像。不同帧产出的标题会拼接为一条单独的字符串。 | [code](../data_juicer/ops/mapper/video_captioning_from_frames_mapper.py)           | [tests](../tests/ops/mapper/test_video_captioning_from_frames_mapper.py)           |
| video_captioning_from_summarizer_mapper        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 通过对多种不同方式生成的文本进行摘要以生成样本的标题（从视频/音频/帧生成标题，从音频/帧生成标签，...）               | [code](../data_juicer/ops/mapper/video_captioning_from_summarizer_mapper.py)       | [tests](../tests/ops/mapper/test_video_captioning_from_summarizer_mapper.py)       |
| video_captioning_from_video_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 生成样本，其标题是根据另一个辅助模型（video-blip）和原始样本中的视频中指定帧的图像。                                 | [code](../data_juicer/ops/mapper/video_captioning_from_video_mapper.py)            | [tests](../tests/ops/mapper/test_video_captioning_from_video_mapper.py)            |
| video_extract_frames_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 从视频中抽帧。                                           | [code](../data_juicer/ops/mapper/video_extract_frames_mapper.py)            | [tests](../tests/ops/mapper/test_video_extract_frames_mapper.py)            |
| video_face_blur_mapper                         | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 对视频中的人脸进行模糊处理                                                                                           | [code](../data_juicer/ops/mapper/video_face_blur_mapper.py)                        | [tests](../tests/ops/mapper/test_video_face_blur_mapper.py)                        |
| video_ffmpeg_wrapped_mapper                    | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 运行 FFmpeg 视频过滤器的简单封装                                                                                     | [code](../data_juicer/ops/mapper/video_ffmpeg_wrapped_mapper.py)                   | [tests](../tests/ops/mapper/test_video_ffmpeg_wrapped_mapper.py)                   |
| video_remove_watermark_mapper                  | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 去除视频中给定区域的水印                                                                                             | [code](../data_juicer/ops/mapper/video_remove_watermark_mapper.py)                 | [tests](../tests/ops/mapper/test_video_remove_watermark_mapper.py)                 |
| video_resize_aspect_ratio_mapper               | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 将视频的宽高比调整到指定范围内                                                                                       | [code](../data_juicer/ops/mapper/video_resize_aspect_ratio_mapper.py)              | [tests](../tests/ops/mapper/test_video_resize_aspect_ratio_mapper.py)              |
| video_resize_resolution_mapper                 | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 将视频映射到给定的分辨率区间                                                                                         | [code](../data_juicer/ops/mapper/video_resize_resolution_mapper.py)                | [tests](../tests/ops/mapper/test_video_resize_resolution_mapper.py)                |
| video_split_by_duration_mapper                 | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 根据时长将视频切分为多个片段                                                                                         | [code](../data_juicer/ops/mapper/video_split_by_duration_mapper.py)                | [tests](../tests/ops/mapper/test_video_split_by_duration_mapper.py)                |
| video_split_by_key_frame_mapper                | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 根据关键帧切分视频                                                                                                   | [code](../data_juicer/ops/mapper/video_split_by_key_frame_mapper.py)               | [tests](../tests/ops/mapper/test_video_split_by_key_frame_mapper.py)               |
| video_split_by_scene_mapper                    | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | 将视频切分为场景片段                                                                                                 | [code](../data_juicer/ops/mapper/video_split_by_scene_mapper.py)                   | [tests](../tests/ops/mapper/test_video_split_by_scene_mapper.py)                   |
| video_tagging_from_audio_mapper                | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 从视频提取的音频中生成视频标签                                                                                       | [code](../data_juicer/ops/mapper/video_tagging_from_audio_mapper.py)               | [tests](../tests/ops/mapper/test_video_tagging_from_audio_mapper.py)               |
| video_tagging_from_frames_mapper               | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | 从视频提取的帧中生成视频标签                                                                                         | [code](../data_juicer/ops/mapper/video_tagging_from_frames_mapper.py)              | [tests](../tests/ops/mapper/test_video_tagging_from_frames_mapper.py)              |
| whitespace_normalization_mapper                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 将各种 Unicode 空白标准化为常规 ASCII 空格 (U+0020)                                                                  | [code](../data_juicer/ops/mapper/whitespace_normalization_mapper.py)               | [tests](../tests/ops/mapper/test_whitespace_normalization_mapper.py)               |

## Filter <a name="filter"/>

| 算子                                  | 标签                                                                                                                                                                                                                                                                                                                          | 描述                                        | 源码                                                                       | 单测样例                                                                     |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| alphanumeric_filter                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留字母数字比例在指定范围内的样本                         | [code](../data_juicer/ops/filter/alphanumeric_filter.py)                 | [tests](../tests/ops/filter/test_alphanumeric_filter.py)                 |
| audio_duration_filter               | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | 保留包含音频的时长在指定范围内的样本                        | [code](../data_juicer/ops/filter/audio_duration_filter.py)               | [tests](../tests/ops/filter/test_audio_duration_filter.py)               |
| audio_nmf_snr_filter                | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | 保留包含音频信噪比SNR（基于非负矩阵分解方法NMF计算）在指定范围内的样本    | [code](../data_juicer/ops/filter/audio_nmf_snr_filter.py)                | [tests](../tests/ops/filter/test_audio_nmf_snr_filter.py)                |
| audio_size_filter                   | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | 保留包含音频的大小（bytes）在指定范围内的样本                 | [code](../data_juicer/ops/filter/audio_size_filter.py)                   | [tests](../tests/ops/filter/test_audio_size_filter.py)                   |
| average_line_length_filter          | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 保留平均行长度在指定范围内的样本                          | [code](../data_juicer/ops/filter/average_line_length_filter.py)          | [tests](../tests/ops/filter/test_average_line_length_filter.py)          |
| character_repetition_filter         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留 char-level n-gram 重复比率在指定范围内的样本        | [code](../data_juicer/ops/filter/character_repetition_filter.py)         | [tests](../tests/ops/filter/test_character_repetition_filter.py)         |
| flagged_words_filter                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留使标记字比率保持在指定阈值以下的样本                      | [code](../data_juicer/ops/filter/flagged_words_filter.py)                | [tests](../tests/ops/filter/test_flagged_words_filter.py)                |
| image_aesthetics_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含美学分数在指定范围内的图像的样本                      | [code](../data_juicer/ops/filter/image_aesthetics_filter.py)             | [tests](../tests/ops/filter/test_image_aesthetics_filter.py)             |
| image_aspect_ratio_filter           | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | 保留样本中包含的图片的宽高比在指定范围内的样本                   | [code](../data_juicer/ops/filter/image_aspect_ratio_filter.py)           | [tests](../tests/ops/filter/test_image_aspect_ratio_filter.py)           |
| image_face_count_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | 保留样本中包含的图片中检测到的人脸数目在指定范围内的样本              | [code](../data_juicer/ops/filter/image_face_count_filter.py)             | [tests](../tests/ops/filter/test_image_face_count_filter.py)             |
| image_face_ratio_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | 保留样本中包含的图片的最大脸部区域在指定范围内的样本                | [code](../data_juicer/ops/filter/image_face_ratio_filter.py)             | [tests](../tests/ops/filter/test_image_face_ratio_filter.py)             |
| image_nsfw_filter                   | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含NSFW分数在指定阈值之下的图像的样本                   | [code](../data_juicer/ops/filter/image_nsfw_filter.py)                   | [tests](../tests/ops/filter/test_image_nsfw_filter.py)                   |
| image_pair_similarity_filter        | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留图像特征余弦相似度(基于CLIP模型)在指定范围内的样本            | [code](../data_juicer/ops/filter/image_pair_similarity_filter.py)        | [tests](../tests/ops/filter/test_image_pair_similarity_filter.py)        |
| image_shape_filter                  | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | 保留样本中包含的图片的形状（即宽和高）在指定范围内的样本              | [code](../data_juicer/ops/filter/image_shape_filter.py)                  | [tests](../tests/ops/filter/test_image_shape_filter.py)                  |
| image_size_filter                   | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | 保留样本中包含的图片的大小（bytes）在指定范围内的样本             | [code](../data_juicer/ops/filter/image_size_filter.py)                   | [tests](../tests/ops/filter/test_image_size_filter.py)                   |
| image_text_matching_filter          | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | 保留图像-文本的分类匹配分(基于BLIP模型)在指定范围内的样本          | [code](../data_juicer/ops/filter/image_text_matching_filter.py)          | [tests](../tests/ops/filter/test_image_text_matching_filter.py)          |
| image_text_similarity_filter        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | 保留图像-文本的特征余弦相似度(基于CLIP模型)在指定范围内的样本        | [code](../data_juicer/ops/filter/image_text_similarity_filter.py)        | [tests](../tests/ops/filter/test_image_text_similarity_filter.py)        |
| image_watermark_filter              | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含有水印概率在指定阈值之下的图像的样本                    | [code](../data_juicer/ops/filter/image_watermark_filter.py)              | [tests](../tests/ops/filter/test_image_watermark_filter.py)              |
| language_id_score_filter            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留特定语言的样本，通过预测的置信度得分来判断                   | [code](../data_juicer/ops/filter/language_id_score_filter.py)            | [tests](../tests/ops/filter/test_language_id_score_filter.py)            |
| maximum_line_length_filter          | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | 保留最大行长度在指定范围内的样本                          | [code](../data_juicer/ops/filter/maximum_line_length_filter.py)          | [tests](../tests/ops/filter/test_maximum_line_length_filter.py)          |
| perplexity_filter                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留困惑度低于指定阈值的样本                            | [code](../data_juicer/ops/filter/perplexity_filter.py)                   | [tests](../tests/ops/filter/test_perplexity_filter.py)                   |
| phrase_grounding_recall_filter      | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | 保留从文本中提取的名词短语在图像中的定位召回率在一定范围内的样本          | [code](../data_juicer/ops/filter/phrase_grounding_recall_filter.py)      | [tests](../tests/ops/filter/test_phrase_grounding_recall_filter.py)      |
| special_characters_filter           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留 special-char 比率的在指定范围内的样本              | [code](../data_juicer/ops/filter/special_characters_filter.py)           | [tests](../tests/ops/filter/test_special_characters_filter.py)           |
| specified_field_filter              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 根据字段过滤样本，要求字段的值处于指定目标中                    | [code](../data_juicer/ops/filter/specified_field_filter.py)              | [tests](../tests/ops/filter/test_specified_field_filter.py)              |
| specified_numeric_field_filter      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 根据字段过滤样本，要求字段的值处于指定范围（针对数字类型）             | [code](../data_juicer/ops/filter/specified_numeric_field_filter.py)      | [tests](../tests/ops/filter/test_specified_numeric_field_filter.py)      |
| stopwords_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留停用词比率高于指定阈值的样本                          | [code](../data_juicer/ops/filter/stopwords_filter.py)                    | [tests](../tests/ops/filter/test_stopwords_filter.py)                    |
| suffix_filter                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                               | 保留包含特定后缀的样本                               | [code](../data_juicer/ops/filter/suffix_filter.py)                       | [tests](../tests/ops/filter/test_suffix_filter.py)                       |
| text_action_filter                  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留文本部分包含动作的样本                             | [code](../data_juicer/ops/filter/text_action_filter.py)                  | [tests](../tests/ops/filter/test_text_action_filter.py)                  |
| text_entity_dependency_filter       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留文本部分的依存树中具有非独立实体的样本                     | [code](../data_juicer/ops/filter/text_entity_dependency_filter.py)       | [tests](../tests/ops/filter/test_text_entity_dependency_filter.py)       |
| text_length_filter                  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留总文本长度在指定范围内的样本                          | [code](../data_juicer/ops/filter/text_length_filter.py)                  | [tests](../tests/ops/filter/test_text_length_filter.py)                  |
| token_num_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic) | 保留token数在指定范围内的样本                         | [code](../data_juicer/ops/filter/token_num_filter.py)                    | [tests](../tests/ops/filter/test_token_num_filter.py)                    |
| video_aesthetics_filter             | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留指定帧的美学分数在指定范围内的样本                       | [code](../data_juicer/ops/filter/video_aesthetics_filter.py)             | [tests](../tests/ops/filter/test_video_aesthetics_filter.py)             |
| video_aspect_ratio_filter           | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | 保留包含视频的宽高比在指定范围内的样本                       | [code](../data_juicer/ops/filter/video_aspect_ratio_filter.py)           | [tests](../tests/ops/filter/test_video_aspect_ratio_filter.py)           |
| video_duration_filter               | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | 保留包含视频的时长在指定范围内的样本                        | [code](../data_juicer/ops/filter/video_duration_filter.py)               | [tests](../tests/ops/filter/test_video_duration_filter.py)               |
| video_frames_text_similarity_filter | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | 保留视频中指定帧的图像-文本的特征余弦相似度(基于CLIP模型)在指定范围内的样本 | [code](../data_juicer/ops/filter/video_frames_text_similarity_filter.py) | [tests](../tests/ops/filter/test_video_frames_text_similarity_filter.py) |
| video_motion_score_filter           | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | 保留包含视频的运动分数（基于稠密光流）在指定范围内的样本                    | [code](../data_juicer/ops/filter/video_motion_score_filter.py)           | [tests](../tests/ops/filter/test_video_motion_score_filter.py)           |
| video_motion_score_raft_filter      | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | 保留包含视频的运动分数（基于 RAFT 模型估计的稠密光流）在指定范围内的样本      | [code](../data_juicer/ops/filter/video_motion_score_raft_raft_filter.py)      | [tests](../tests/ops/filter/test_video_motion_score_filter.py)      |
| video_nsfw_filter                   | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含视频的NSFW分数在指定阈值之下的样本                                  | [code](../data_juicer/ops/filter/video_nsfw_filter.py)                   | [tests](../tests/ops/filter/test_video_nsfw_filter.py)                   |
| video_ocr_area_ratio_filter         | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含视频的特定帧中检测出的文本的面积占比在指定范围内的样本              | [code](../data_juicer/ops/filter/video_ocr_area_ratio_filter.py)         | [tests](../tests/ops/filter/test_video_ocr_area_ratio_filter.py)         |
| video_resolution_filter             | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | 保留包含视频的分辨率（包括横向分辨率和纵向分辨率）在指定范围内的样本        | [code](../data_juicer/ops/filter/video_resolution_filter.py)             | [tests](../tests/ops/filter/test_video_resolution_filter.py)             |
| video_watermark_filter              | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | 保留包含视频有水印的概率在指定阈值之下的样本                                | [code](../data_juicer/ops/filter/video_watermark_filter.py)              | [tests](../tests/ops/filter/test_video_watermark_filter.py)              |
| video_tagging_from_frames_filter    | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | 保留包含具有给定标签视频的样本                                              | [code](../data_juicer/ops/filter/video_tagging_from_frames_filter.py)    | [tests](../tests/ops/filter/test_video_tagging_from_frames_filter.py)    |
| words_num_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留字数在指定范围内的样本                                                  | [code](../data_juicer/ops/filter/words_num_filter.py)                    | [tests](../tests/ops/filter/test_words_num_filter.py)                    |
| word_repetition_filter              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | 保留 word-level n-gram 重复比率在指定范围内的样本                           | [code](../data_juicer/ops/filter/word_repetition_filter.py)              | [tests](../tests/ops/filter/test_word_repetition_filter.py)              |

## Deduplicator <a name="deduplicator"/>

| 算子                             | 标签                                                                                                                                                                                                                                                            | 描述                                  | 源码                                                                       | 单测样例                                                                     |
|--------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| document_deduplicator          | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 通过比较 MD5 哈希值在文档级别对样本去重              | [code](../data_juicer/ops/deduplicator/document_deduplicator.py)         | [tests](../tests/ops/deduplicator/test_document_deduplicator.py)         |
| document_minhash_deduplicator  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 使用 MinHashLSH 在文档级别对样本去重            | [code](../data_juicer/ops/deduplicator/document_minhash_deduplicator.py) | [tests](../tests/ops/deduplicator/test_document_minhash_deduplicator.py) |
| document_simhash_deduplicator  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 使用 SimHash 在文档级别对样本去重               | [code](../data_juicer/ops/deduplicator/document_simhash_deduplicator.py) | [tests](../tests/ops/deduplicator/test_document_simhash_deduplicator.py) |
| image_deduplicator             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                             | 使用文档之间图像的精确匹配在文档级别删除重复样本            | [code](../data_juicer/ops/deduplicator/image_deduplicator.py)            | [tests](../tests/ops/deduplicator/test_image_deduplicator.py)            |
| video_deduplicator             | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                             | 使用文档之间视频的精确匹配在文档级别删除重复样本            | [code](../data_juicer/ops/deduplicator/video_deduplicator.py)            | [tests](../tests/ops/deduplicator/test_video_deduplicator.py)            |
| ray_document_deduplicator      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | 通过比较 MD5 哈希值在文档级别对样本去重，面向RAY分布式模式   | [code](../data_juicer/ops/deduplicator/ray_document_deduplicator.py)     | -                                                                        |
| ray_image_deduplicator         | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                             | 使用文档之间图像的精确匹配在文档级别删除重复样本，面向RAY分布式模式 | [code](../data_juicer/ops/deduplicator/ray_image_deduplicator.py)        | -                                                                        |
| ray_video_deduplicator         | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                             | 使用文档之间视频的精确匹配在文档级别删除重复样本，面向RAY分布式模式 | [code](../data_juicer/ops/deduplicator/ray_video_deduplicator.py)        | -                                                                        |

## Selector <a name="selector"/>

| 算子                                  | 标签                                                                                                                                                                                             | 描述                       | 源码                                                                        | 单测样例                                                                      |
|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------|
| frequency_specified_field_selector  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)  | 通过比较指定字段的频率选出前 k 个样本     | [code](../data_juicer/ops/selector/frequency_specified_field_selector.py) | [tests](../tests/ops/selector/test_frequency_specified_field_selector.py) |
| random_selector                     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)  | 随机筛选 k 个样本               | [code](../data_juicer/ops/selector/random_selector.py)                    | [tests](../tests/ops/selector/test_random_selector.py)                    |
| range_specified_field_selector      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)  | 通过比较指定字段的值选出指定范围的 k 个样本  | [code](../data_juicer/ops/selector/range_specified_field_selector.py)     | [tests](../tests/ops/selector/test_range_specified_field_selector.py)     |
| topk_specified_field_selector       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)  | 通过比较指定字段的值选出前 k 个样本      | [code](../data_juicer/ops/selector/topk_specified_field_selector.py)      | [tests](../tests/ops/selector/test_topk_specified_field_selector.py)      |

## Grouper <a name="grouper"/>

| 算子                                  | 标签                                                                                                                                                                                             | 描述                       | 源码                                                                        | 单测样例                                                                      |
|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------|
| key_value_grouper                                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 根据给定键的值将样本分组，每一组组成一个批量样本。                                                                                                                                    | [code](../data_juicer/ops/grouper/key_value_grouper.py)                          | [tests](../tests/ops/grouper/test_key_value_grouper.py)                              |
| naive_grouper                                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 将所有样本分为一个组，返回一个批量样本                                                                                                                                    | [code](../data_juicer/ops/grouper/naive_grouper.py)                          | [tests](../tests/ops/grouper/test_naive_grouper.py)                              |

## Aggregator <a name="aggregator"/>

| 算子                                  | 标签                                                                                                                                                                                             | 描述                       | 源码                                                                        | 单测样例                                                                      |
|-------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------|
| entity_attribute_aggregator                                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 从一些文本中总结出给定实体的属性                                                                                                                                   | [code](../data_juicer/ops/aggregator/entity_attribute_aggregator.py)                          | [tests](../tests/ops/aggregator/test_entity_attribute_aggregator.py)                              |
| most_relavant_entities_aggregator                                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 从一些文本中抽取出与给定实体密切相关的实体，按重要性从高到低排序                                                                                                                              | [code](../data_juicer/ops/aggregator/most_relavant_entities_aggregator.py)                          | [tests](../tests/ops/aggregator/test_most_relavant_entities_aggregator.py)                              |
| nested_aggregator                                                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | 考虑到输入长度的限制，对样本中的内容进行嵌套聚合。                                                                                                                                 | [code](../data_juicer/ops/aggregator/nested_aggregator.py)                          | [tests](../tests/ops/aggregator/test_nested_aggregator.py)                              |

## 贡献
我们欢迎社区贡献新的算子，具体请参考[开发者指南](DeveloperGuide_ZH.md)。
