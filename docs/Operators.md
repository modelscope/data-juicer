# Operator Schemas

Operators are a collection of basic processes that assist in data modification, cleaning, filtering, deduplication, etc. We support a wide range of data sources and file formats, and allow for flexible extension to custom datasets.

This page offers a basic description of the operators (OPs) in Data-Juicer. Users can refer to the [API documentation](https://modelscope.github.io/data-juicer/) for the specific parameters of each operator. Users can refer to and run the unit tests (`tests/ops/...`) for [examples of operator-wise usage](../tests/ops) as well as the effects of each operator when applied to built-in test data samples.

## Overview

The operators in Data-Juicer are categorized into 5 types.

| Type                              | Number | Description                                     |
|-----------------------------------|:------:|-------------------------------------------------|
| [ Formatter ]( #formatter )       |   9    | Discovers, loads, and canonicalizes source data |
| [ Mapper ]( #mapper )             |   61   | Edits and transforms samples                    |
| [ Filter ]( #filter )             |   44   | Filters out low-quality samples                 |
| [ Deduplicator ]( #deduplicator ) |   8    | Detects and removes duplicate samples           |
| [ Selector ]( #selector )         |   4    | Selects top samples based on ranking            |


All the specific operators are listed below, each featured with several capability tags.

* Domain Tags
    - ![General](https://img.shields.io/badge/General-5FBF50?style=plastic): general purpose
    - ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic): specific to LaTeX source files
    - ![Code](https://img.shields.io/badge/Code-590F08?style=plastic): specific to programming codes
    - ![Financial](https://img.shields.io/badge/Financial-A64C44?style=plastic): closely related to financial sector
* Modality Tags
    - ![Text](https://img.shields.io/badge/Text-010326?style=plastic): specific to text
    - ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic): specific to images
    - ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic): specific to audios
    - ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic): specific to videos
    - ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic): specific to multimodal
* Language Tags
    - ![en](https://img.shields.io/badge/en-A60D1A?style=plastic): English
    - ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic): Chinese
* Resource Tags
    - ![CPU](https://img.shields.io/badge/CPU-F2AA6B?style=plastic): only requires CPU resource (default)
    - ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic): requires GPU/CUDA resource as well


## Formatter <a name="formatter"/>

| Operator          | Tags                                                                                                                                                                                          | Description                                                                                       | Source code                                        | Unit tests                                         |
|-------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------|----------------------------------------------------|----------------------------------------------------|
| local_formatter   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares datasets from local files                                                                | [code](../data_juicer/format/formatter.py)         | [tests](../tests/format/test_unify_format.py)      |
| remote_formatter  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares datasets from remote (e.g., HuggingFace)                                                 | [code](../data_juicer/format/formatter.py)         | [tests](../tests/format/test_unify_format.py)      |
| csv_formatter     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares local `.csv` files                                                                       | [code](../data_juicer/format/csv_formatter.py)     | [tests](../tests/format/test_csv_formatter.py)     |
| tsv_formatter     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares local `.tsv` files                                                                       | [code](../data_juicer/format/tsv_formatter.py)     | [tests](../tests/format/test_tsv_formatter.py)     |
| json_formatter    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares local `.json`, `.jsonl`, `.jsonl.zst` files                                              | [code](../data_juicer/format/json_formatter.py)    | -                                                  |
| parquet_formatter | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares local `.parquet` files                                                                   | [code](../data_juicer/format/parquet_formatter.py) | [tests](../tests/format/test_parquet_formatter.py) |
| text_formatter    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Prepares other local text files ([complete list](../data_juicer/format/text_formatter.py#L63,73)) | [code](../data_juicer/format/text_formatter.py)    | -                                                  |
| empty_formatter   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic)                                                                                                                         | Prepares an empty dataset                                                                         | [code](../data_juicer/format/empty_formatter.py)   | [tests](../tests/format/test_empty_formatter.py)   |
| mixture_formatter | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Handles a mixture of all the supported local file types                                           | [code](../data_juicer/format/mixture_formatter.py) | [tests](../tests/format/test_mixture_formatter.py) |

## Mapper <a name="mapper"/>

| Operator                                       | Tags                                                                                                                                                                                                                                                                                                                          | Description                                                                                                                                                                    | Source code                                                                        | Unit tests                                                                         |
|------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|------------------------------------------------------------------------------------|
| audio_ffmpeg_wrapped_mapper                    | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                             | Simple wrapper to run a FFmpeg audio filter                                                                                                                                    | [code](../data_juicer/ops/mapper/audio_ffmpeg_wrapped_mapper.py)                   | [tests](../tests/ops/mapper/test_audio_ffmpeg_wrapped_mapper.py)                   |
| calibrate_qa_mapper                            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Calibrate question-answer pairs based on reference text                                                                                                                        | [code](../data_juicer/ops/mapper/calibrate_qa_mapper.py)                           | [tests](../tests/ops/mapper/test_calibrate_qa_mapper.py)                           |
| calibrate_query_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Calibrate query in question-answer pairs based on reference text                                                                                                               | [code](../data_juicer/ops/mapper/calibrate_query_mapper.py)                        | [tests](../tests/ops/mapper/test_calibrate_query_mapper.py)                        |
| calibrate_response_mapper                      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Calibrate response in question-answer pairs based on reference text                                                                                                            | [code](../data_juicer/ops/mapper/calibrate_response_mapper.py)                     | [tests](../tests/ops/mapper/test_calibrate_response_mapper.py)                     |
| chinese_convert_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                             | Converts Chinese between Traditional Chinese, Simplified Chinese and Japanese Kanji (by [opencc](https://github.com/BYVoid/OpenCC))                                            | [code](../data_juicer/ops/mapper/chinese_convert_mapper.py)                        | [tests](../tests/ops/mapper/test_chinese_convert_mapper.py)                        |
| clean_copyright_mapper                         | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                       | Removes copyright notice at the beginning of code files (must contain the word *copyright*)                                                                                    | [code](../data_juicer/ops/mapper/clean_copyright_mapper.py)                        | [tests](../tests/ops/mapper/test_clean_copyright_mapper.py)                        |
| clean_email_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes email information                                                                                                                                                      | [code](../data_juicer/ops/mapper/clean_email_mapper.py)                            | [tests](../tests/ops/mapper/test_clean_email_mapper.py)                            |
| clean_html_mapper                              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes HTML tags and returns plain text of all the nodes                                                                                                                      | [code](../data_juicer/ops/mapper/clean_html_mapper.py)                             | [tests](../tests/ops/mapper/test_clean_html_mapper.py)                             |
| clean_ip_mapper                                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes IP addresses                                                                                                                                                           | [code](../data_juicer/ops/mapper/clean_ip_mapper.py)                               | [tests](../tests/ops/mapper/test_clean_ip_mapper.py)                               |
| clean_links_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Removes links, such as those starting with http or ftp                                                                                                                         | [code](../data_juicer/ops/mapper/clean_links_mapper.py)                            | [tests](../tests/ops/mapper/test_clean_links_mapper.py)                            |
| expand_macro_mapper                            | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Expands macros usually defined at the top of TeX documents                                                                                                                     | [code](../data_juicer/ops/mapper/expand_macro_mapper.py)                           | [tests](../tests/ops/mapper/test_expand_macro_mapper.py)                           |
| extract_entity_attribute_mapper                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Extract attributes for given entities from the text.                                                                                                                     | [code](../data_juicer/ops/mapper/extract_entity_attribute_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_entity_attribute_mapper.py)                           |
| extract_entity_relation_mapper                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Extract entities and relations in the text for knowledge graph.                                                                                                                    | [code](../data_juicer/ops/mapper/extract_entity_relation_mapper.py)                            | [tests](../tests/ops/mapper/test_extract_entity_relation_mapper.py)                           |
| extract_event_mapper                           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Extract events and relevant characters in the text.                                                                                                                     | [code](../data_juicer/ops/mapper/extract_event_mapper.py)                                              | [tests](../tests/ops/mapper/test_extract_event_mapper.py)                           |
| extract_keyword_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Generate keywords for the text.                                                                                                                     | [code](../data_juicer/ops/mapper/extract_keyword_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_keyword_mapper.py)                           |
| extract_nickname_mapper                        | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Extract nickname relationship in the text.                                                                                                                     | [code](../data_juicer/ops/mapper/extract_nickname_mapper.py)                           | [tests](../tests/ops/mapper/test_extract_nickname_mapper.py)                           |
| fix_unicode_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Fixes broken Unicodes (by [ftfy](https://ftfy.readthedocs.io/))                                                                                                                | [code](../data_juicer/ops/mapper/fix_unicode_mapper.py)                            | [tests](../tests/ops/mapper/test_fix_unicode_mapper.py)                            |
| generate_qa_from_examples_mapper               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | Generate question and answer pairs based on examples.                                                                                                                          | [code](../data_juicer/ops/mapper/generate_qa_from_examples_mapper.py)              | [tests](../tests/ops/mapper/test_generate_qa_from_examples_mapper.py)              |
| generate_qa_from_text_mapper                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | Generate question and answer pairs from text.                                                                                                                                  | [code](../data_juicer/ops/mapper/generate_qa_from_text_mapper.py)                  | [tests](../tests/ops/mapper/test_generate_qa_from_text_mapper.py)                  |
| image_blur_mapper                              | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                             | Blur images                                                                                                                                                                    | [code](../data_juicer/ops/mapper/image_blur_mapper.py)                             | [tests](../tests/ops/mapper/test_image_blur_mapper.py)                             |
| image_captioning_from_gpt4v_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic)                                                                                                                                                                                                                                                   | generate samples whose texts are generated based on gpt-4-visison and the image                                                                                                | [code](../data_juicer/ops/mapper/image_captioning_from_gpt4v_mapper.py)            | -                                                                                  |
| image_captioning_mapper                        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | generate samples whose captions are generated based on another model (such as blip2) and the figure within the original sample                                                 | [code](../data_juicer/ops/mapper/image_captioning_mapper.py)                       | [tests](../tests/ops/mapper/test_image_captioning_mapper.py)                       |
| image_diffusion_mapper                         | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Generate and augment images by stable diffusion model                                                                                                                          | [code](../data_juicer/ops/mapper/image_diffusion_mapper.py)                        | [tests](../tests/ops/mapper/test_image_diffusion_mapper.py)                        |
| image_face_blur_mapper                         | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                             | Blur faces detected in images                                                                                                                                                  | [code](../data_juicer/ops/mapper/image_face_blur_mapper.py)                        | [tests](../tests/ops/mapper/test_image_face_blur_mapper.py)                        |
| image_tagging_mapper                           | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Mapper to generate image tags from the input images.                                                                                                                           | [code](../data_juicer/ops/mapper/image_tagging_mapper.py)                          | [tests](../tests/ops/mapper/test_image_tagging_mapper.py)                          |
| nlpaug_en_mapper                               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                                                                                             | Simply augments texts in English based on the `nlpaug` library                                                                                                                 | [code](../data_juicer/ops/mapper/nlpaug_en_mapper.py)                              | [tests](../tests/ops/mapper/test_nlpaug_en_mapper.py)                              |
| nlpcda_zh_mapper                               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                             | Simply augments texts in Chinese based on the `nlpcda` library                                                                                                                 | [code](../data_juicer/ops/mapper/nlpcda_zh_mapper.py)                              | [tests](../tests/ops/mapper/test_nlpcda_zh_mapper.py)                              |
| optimize_qa_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | Optimize both the query and response in question-answering samples.                                                                                                            | [code](../data_juicer/ops/mapper/optimize_qa_mapper.py)                            | [tests](../tests/ops/mapper/test_optimize_qa_mapper.py)                            |
| optimize_query_mapper                          | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | Optimize the query in question-answering samples.                                                                                                                              | [code](../data_juicer/ops/mapper/optimize_query_mapper.py)                         | [tests](../tests/ops/mapper/test_optimize_query_mapper.py)                         |
| optimize_response_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)   | Optimize the response in question-answering samples.                                                                                                                           | [code](../data_juicer/ops/mapper/optimize_response_mapper.py)                      | [tests](../tests/ops/mapper/test_optimize_response_mapper.py)                      |
| pair_preference_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Construct paired preference samples.                                                                                                                                           | [code](../data_juicer/ops/mapper/pair_preference_mapper.py)                        | [tests](../tests/ops/mapper/test_pair_preference_mapper.py)                        |
| punctuation_normalization_mapper               | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Normalizes various Unicode punctuations to their ASCII equivalents                                                                                                             | [code](../data_juicer/ops/mapper/punctuation_normalization_mapper.py)              | [tests](../tests/ops/mapper/test_punctuation_normalization_mapper.py)              |
| python_file_mapper                             | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Executing Python function defined in a file                                                                                                                                    | [code](../data_juicer/ops/mapper/python_file_mapper.py)                            | [tests](../tests/ops/mapper/test_python_file_mapper.py)                            |
| python_lambda_mapper                           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Executing Python lambda function on data samples                                                                                                                               | [code](../data_juicer/ops/mapper/python_lambda_mapper.py)                          | [tests](../tests/ops/mapper/test_python_lambda_mapper.py)                          |
| remove_bibliography_mapper                     | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Removes the bibliography of TeX documents                                                                                                                                      | [code](../data_juicer/ops/mapper/remove_bibliography_mapper.py)                    | [tests](../tests/ops/mapper/test_remove_bibliography_mapper.py)                    |
| remove_comments_mapper                         | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Removes the comments of TeX documents                                                                                                                                          | [code](../data_juicer/ops/mapper/remove_comments_mapper.py)                        | [tests](../tests/ops/mapper/test_remove_comments_mapper.py)                        |
| remove_header_mapper                           | ![LaTeX](https://img.shields.io/badge/LaTeX-D99379?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Removes the running headers of TeX documents, e.g., titles, chapter or section numbers/names                                                                                   | [code](../data_juicer/ops/mapper/remove_header_mapper.py)                          | [tests](../tests/ops/mapper/test_remove_header_mapper.py)                          |
| remove_long_words_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes words with length outside the specified range                                                                                                                          | [code](../data_juicer/ops/mapper/remove_long_words_mapper.py)                      | [tests](../tests/ops/mapper/test_remove_long_words_mapper.py)                      |
| remove_non_chinese_character_mapper            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Remove non Chinese character in text samples.                                                                                                                                  | [code](../data_juicer/ops/mapper/remove_non_chinese_character_mapper.py)           | [tests](../tests/ops/mapper/test_remove_non_chinese_character_mapper.py)           |
| remove_repeat_sentences_mapper                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Remove repeat sentences in text samples.                                                                                                                                       | [code](../data_juicer/ops/mapper/remove_repeat_sentences_mapper.py)                | [tests](../tests/ops/mapper/test_remove_repeat_sentences_mapper.py)                |
| remove_specific_chars_mapper                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes any user-specified characters or substrings                                                                                                                            | [code](../data_juicer/ops/mapper/remove_specific_chars_mapper.py)                  | [tests](../tests/ops/mapper/test_remove_specific_chars_mapper.py)                  |
| remove_table_text_mapper                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![Financial](https://img.shields.io/badge/Financial-A64C44?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                   | Detects and removes possible table contents (:warning: relies on regular expression matching and thus fragile)                                                                 | [code](../data_juicer/ops/mapper/remove_table_text_mapper.py)                      | [tests](../tests/ops/mapper/test_remove_table_text_mapper.py)                      |
| remove_words_with_incorrect_ substrings_mapper | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Removes words containing specified substrings                                                                                                                                  | [code](../data_juicer/ops/mapper/remove_words_with_incorrect_substrings_mapper.py) | [tests](../tests/ops/mapper/test_remove_words_with_incorrect_substrings_mapper.py) |
| replace_content_mapper                         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Replace all content in the text that matches a specific regular expression pattern with a designated replacement string                                                        | [code](../data_juicer/ops/mapper/replace_content_mapper.py)                        | [tests](../tests/ops/mapper/test_replace_content_mapper.py)                        |
| sentence_split_mapper                          | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic)                                                                                                                             | Splits and reorganizes sentences according to semantics                                                                                                                        | [code](../data_juicer/ops/mapper/sentence_split_mapper.py)                         | [tests](../tests/ops/mapper/test_sentence_split_mapper.py)                         |
| text_chunk_mapper                              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Split input text to chunks.                                                                                                                  | [code](../data_juicer/ops/mapper/text_chunk_mapper.py)                           | [tests](../tests/ops/mapper/test_text_chunk_mapper.py)                           |
| video_captioning_from_audio_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Caption a video according to its audio streams based on Qwen-Audio model                                                                                                       | [code](../data_juicer/ops/mapper/video_captioning_from_audio_mapper.py)            | [tests](../tests/ops/mapper/test_video_captioning_from_audio_mapper.py)            |
| video_captioning_from_frames_mapper            | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | generate samples whose captions are generated based on an image-to-text model and sampled video frames. Captions from different frames will be concatenated to a single string | [code](../data_juicer/ops/mapper/video_captioning_from_frames_mapper.py)           | [tests](../tests/ops/mapper/test_video_captioning_from_frames_mapper.py)           |
| video_captioning_from_summarizer_mapper        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Generate video captions by summarizing several kinds of generated texts (captions from video/audio/frames, tags from audio/frames, ...)                                        | [code](../data_juicer/ops/mapper/video_captioning_from_summarizer_mapper.py)       | [tests](../tests/ops/mapper/test_video_captioning_from_summarizer_mapper.py)       |
| video_captioning_from_video_mapper             | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | generate samples whose captions are generated based on another model (video-blip) and sampled video frame within the original sample                                           | [code](../data_juicer/ops/mapper/video_captioning_from_video_mapper.py)            | [tests](../tests/ops/mapper/test_video_captioning_from_video_mapper.py)            |
| video_face_blur_mapper                         | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Blur faces detected in videos                                                                                                                                                  | [code](../data_juicer/ops/mapper/video_face_blur_mapper.py)                        | [tests](../tests/ops/mapper/test_video_face_blur_mapper.py)                        |
| video_ffmpeg_wrapped_mapper                    | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Simple wrapper to run a FFmpeg video filter                                                                                                                                    | [code](../data_juicer/ops/mapper/video_ffmpeg_wrapped_mapper.py)                   | [tests](../tests/ops/mapper/test_video_ffmpeg_wrapped_mapper.py)                   |
| video_remove_watermark_mapper                  | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Remove the watermarks in videos given regions                                                                                                                                  | [code](../data_juicer/ops/mapper/video_remove_watermark_mapper.py)                 | [tests](../tests/ops/mapper/test_video_remove_watermark_mapper.py)                 |
| video_resize_aspect_ratio_mapper               | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Resize video aspect ratio to a specified range                                                                                                                                 | [code](../data_juicer/ops/mapper/video_resize_aspect_ratio_mapper.py)              | [tests](../tests/ops/mapper/test_video_resize_aspect_ratio_mapper.py)              |
| video_resize_resolution_mapper                 | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Map videos to ones with given resolution range                                                                                                                                 | [code](../data_juicer/ops/mapper/video_resize_resolution_mapper.py)                | [tests](../tests/ops/mapper/test_video_resize_resolution_mapper.py)                |
| video_split_by_duration_mapper                 | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Mapper to split video by duration                                                                                                                                              | [code](../data_juicer/ops/mapper/video_split_by_duration_mapper.py)                | [tests](../tests/ops/mapper/test_video_split_by_duration_mapper.py)                |
| video_split_by_key_frame_mapper                | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Mapper to split video by key frame                                                                                                                                             | [code](../data_juicer/ops/mapper/video_split_by_key_frame_mapper.py)               | [tests](../tests/ops/mapper/test_video_split_by_key_frame_mapper.py)               |
| video_split_by_scene_mapper                    | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                             | Split videos into scene clips                                                                                                                                                  | [code](../data_juicer/ops/mapper/video_split_by_scene_mapper.py)                   | [tests](../tests/ops/mapper/test_video_split_by_scene_mapper.py)                   |
| video_tagging_from_audio_mapper                | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Mapper to generate video tags from audio streams extracted from the video.                                                                                                     | [code](../data_juicer/ops/mapper/video_tagging_from_audio_mapper.py)               | [tests](../tests/ops/mapper/test_video_tagging_from_audio_mapper.py)               |
| video_tagging_from_frames_mapper               | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                     | Mapper to generate video tags from frames extracted from the video.                                                                                                            | [code](../data_juicer/ops/mapper/video_tagging_from_frames_mapper.py)              | [tests](../tests/ops/mapper/test_video_tagging_from_frames_mapper.py)              |
| whitespace_normalization_mapper                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                 | Normalizes various Unicode whitespaces to the normal ASCII space (U+0020)                                                                                                      | [code](../data_juicer/ops/mapper/whitespace_normalization_mapper.py)               | [tests](../tests/ops/mapper/test_whitespace_normalization_mapper.py)               |

## Filter <a name="filter"/>

| Operator                            | Tags                                                                                                                                                                                                                                                                                                                        | Description                                                                                                                                          | Source code                                                              | Unit tests                                                               |
|-------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| alphanumeric_filter                 | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with alphanumeric ratio within the specified range                                                                                     | [code](../data_juicer/ops/filter/alphanumeric_filter.py)                 | [tests](../tests/ops/filter/test_alphanumeric_filter.py)                 |
| audio_duration_filter               | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | Keep data samples whose audios' durations are within a specified range                                                                               | [code](../data_juicer/ops/filter/audio_duration_filter.py)               | [tests](../tests/ops/filter/test_audio_duration_filter.py)               |
| audio_nmf_snr_filter                | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | Keep data samples whose audios' Signal-to-Noise Ratios (SNRs, computed based on Non-Negative Matrix Factorization, NMF) are within a specified range | [code](../data_juicer/ops/filter/audio_nmf_snr_filter.py)                | [tests](../tests/ops/filter/test_audio_nmf_snr_filter.py)                |
| audio_size_filter                   | ![Audio](https://img.shields.io/badge/Audio-0DA64F?style=plastic)                                                                                                                                                                                                                                                           | Keep data samples whose audios' sizes are within a specified range                                                                                   | [code](../data_juicer/ops/filter/audio_size_filter.py)                   | [tests](../tests/ops/filter/test_audio_size_filter.py)                   |
| average_line_length_filter          | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Keeps samples with average line length within the specified range                                                                                    | [code](../data_juicer/ops/filter/average_line_length_filter.py)          | [tests](../tests/ops/filter/test_average_line_length_filter.py)          |
| character_repetition_filter         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with char-level n-gram repetition ratio within the specified range                                                                     | [code](../data_juicer/ops/filter/character_repetition_filter.py)         | [tests](../tests/ops/filter/test_character_repetition_filter.py)         |
| flagged_words_filter                | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with flagged-word ratio below the specified threshold                                                                                  | [code](../data_juicer/ops/filter/flagged_words_filter.py)                | [tests](../tests/ops/filter/test_flagged_words_filter.py)                |
| image_aesthetics_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples containing images whose aesthetics scores are within the specified range                                                               | [code](../data_juicer/ops/filter/image_aesthetics_filter.py)             | [tests](../tests/ops/filter/test_image_aesthetics_filter.py)             |
| image_aspect_ratio_filter           | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing images with aspect ratios within the specified range                                                                        | [code](../data_juicer/ops/filter/image_aspect_ratio_filter.py)           | [tests](../tests/ops/filter/test_image_aspect_ratio_filter.py)           |
| image_face_count_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing images with face counts within the specified range                                                                          | [code](../data_juicer/ops/filter/image_face_count_filter.py)             | [tests](../tests/ops/filter/test_image_face_count_filter.py)             |
| image_face_ratio_filter             | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing images with face area ratios within the specified range                                                                     | [code](../data_juicer/ops/filter/image_face_ratio_filter.py)             | [tests](../tests/ops/filter/test_image_face_ratio_filter.py)             |
| image_nsfw_filter                   | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples containing images with NSFW scores below the threshold                                                                                 | [code](../data_juicer/ops/filter/image_nsfw_filter.py)                   | [tests](../tests/ops/filter/test_image_nsfw_filter.py)                   |
| image_pair_similarity_filter        | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps image pairs with image feature cosine similarity within the specified range based on a CLIP model                                              | [code](../data_juicer/ops/filter/image_pair_similarity_filter.py)        | [tests](../tests/ops/filter/test_image_pair_similarity_filter.py)        |
| image_shape_filter                  | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing images with widths and heights within the specified range                                                                   | [code](../data_juicer/ops/filter/image_shape_filter.py)                  | [tests](../tests/ops/filter/test_image_shape_filter.py)                  |
| image_size_filter                   | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing images whose size in bytes are within the specified range                                                                   | [code](../data_juicer/ops/filter/image_size_filter.py)                   | [tests](../tests/ops/filter/test_image_size_filter.py)                   |
| image_text_matching_filter          | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | Keeps samples with image-text classification matching score within the specified range based on a BLIP model                                         | [code](../data_juicer/ops/filter/image_text_matching_filter.py)          | [tests](../tests/ops/filter/test_image_text_matching_filter.py)          |
| image_text_similarity_filter        | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | Keeps samples with image-text feature cosine similarity within the specified range based on a CLIP model                                             | [code](../data_juicer/ops/filter/image_text_similarity_filter.py)        | [tests](../tests/ops/filter/test_image_text_similarity_filter.py)        |
| image_watermark_filter              | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples containing images with predicted watermark probabilities below the threshold                                                           | [code](../data_juicer/ops/filter/image_watermark_filter.py)              | [tests](../tests/ops/filter/test_image_watermark_filter.py)              |
| language_id_score_filter            | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples of the specified language, judged by a predicted confidence score                                                                      | [code](../data_juicer/ops/filter/language_id_score_filter.py)            | [tests](../tests/ops/filter/test_language_id_score_filter.py)            |
| maximum_line_length_filter          | ![Code](https://img.shields.io/badge/Code-590F08?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                     | Keeps samples with maximum line length within the specified range                                                                                    | [code](../data_juicer/ops/filter/maximum_line_length_filter.py)          | [tests](../tests/ops/filter/test_maximum_line_length_filter.py)          |
| perplexity_filter                   | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with perplexity score below the specified threshold                                                                                    | [code](../data_juicer/ops/filter/perplexity_filter.py)                   | [tests](../tests/ops/filter/test_perplexity_filter.py)                   |
| phrase_grounding_recall_filter      | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | Keeps samples whose locating recalls of phrases extracted from text in the images are within a specified range                                       | [code](../data_juicer/ops/filter/phrase_grounding_recall_filter.py)      | [tests](../tests/ops/filter/test_phrase_grounding_recall_filter.py)      |
| special_characters_filter           | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with special-char ratio within the specified range                                                                                     | [code](../data_juicer/ops/filter/special_characters_filter.py)           | [tests](../tests/ops/filter/test_special_characters_filter.py)           |
| specified_field_filter              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Filters samples based on field, with value lies in the specified targets                                                                             | [code](../data_juicer/ops/filter/specified_field_filter.py)              | [tests](../tests/ops/filter/test_specified_field_filter.py)              |
| specified_numeric_field_filter      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Filters samples based on field, with value lies in the specified range (for numeric types)                                                           | [code](../data_juicer/ops/filter/specified_numeric_field_filter.py)      | [tests](../tests/ops/filter/test_specified_numeric_field_filter.py)      |
| stopwords_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with stopword ratio above the specified threshold                                                                                      | [code](../data_juicer/ops/filter/stopwords_filter.py)                    | [tests](../tests/ops/filter/test_stopwords_filter.py)                    |
| suffix_filter                       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                                                                                               | Keeps samples with specified suffixes                                                                                                                | [code](../data_juicer/ops/filter/suffix_filter.py)                       | [tests](../tests/ops/filter/test_suffix_filter.py)                       |
| text_action_filter                  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples containing action verbs in their texts                                                                                                 | [code](../data_juicer/ops/filter/text_action_filter.py)                  | [tests](../tests/ops/filter/test_text_action_filter.py)                  |
| text_entity_dependency_filter       | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples containing dependency edges for an entity in the dependency tree of the texts                                                          | [code](../data_juicer/ops/filter/text_entity_dependency_filter.py)       | [tests](../tests/ops/filter/test_text_entity_dependency_filter.py)       |
| text_length_filter                  | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with total text length within the specified range                                                                                      | [code](../data_juicer/ops/filter/text_length_filter.py)                  | [tests](../tests/ops/filter/test_text_length_filter.py)                  |
| token_num_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic) | Keeps samples with token count within the specified range                                                                                            | [code](../data_juicer/ops/filter/token_num_filter.py)                    | [tests](../tests/ops/filter/test_token_num_filter.py)                    |
| video_aesthetics_filter             | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples whose specified frames have aesthetics scores within the specified range                                                               | [code](../data_juicer/ops/filter/video_aesthetics_filter.py)             | [tests](../tests/ops/filter/test_video_aesthetics_filter.py)             |
| video_aspect_ratio_filter           | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing videos with aspect ratios within the specified range                                                                        | [code](../data_juicer/ops/filter/video_aspect_ratio_filter.py)           | [tests](../tests/ops/filter/test_video_aspect_ratio_filter.py)           |
| video_duration_filter               | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | Keep data samples whose videos' durations are within a specified range                                                                               | [code](../data_juicer/ops/filter/video_duration_filter.py)               | [tests](../tests/ops/filter/test_video_duration_filter.py)               |
| video_frames_text_similarity_filter | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | Keep data samples whose similarities between sampled video frame images and text are within a specific range                                         | [code](../data_juicer/ops/filter/video_frames_text_similarity_filter.py) | [tests](../tests/ops/filter/test_video_frames_text_similarity_filter.py) |
| video_motion_score_filter           | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | Keep samples with video motion scores within a specific range                                                                                        | [code](../data_juicer/ops/filter/video_motion_score_filter.py)           | [tests](../tests/ops/filter/test_video_motion_score_filter.py)           |
| video_motion_score_raft_filter      | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | Keep samples with video motion scores (based on RAFT model) within a specific range                                                                  | [code](../data_juicer/ops/filter/video_motion_score_raft_filter.py)      | [tests](../tests/ops/filter/test_video_motion_score_raft_filter.py)      |
| video_nsfw_filter                   | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples containing videos with NSFW scores below the threshold                                                                                 | [code](../data_juicer/ops/filter/video_nsfw_filter.py)                   | [tests](../tests/ops/filter/test_video_nsfw_filter.py)                   |
| video_ocr_area_ratio_filter         | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keep data samples whose detected text area ratios for specified frames in the video are within a specified range                                     | [code](../data_juicer/ops/filter/video_ocr_area_ratio_filter.py)         | [tests](../tests/ops/filter/test_video_ocr_area_ratio_filter.py)         |
| video_resolution_filter             | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                                                                                           | Keeps samples containing videos with horizontal and vertical resolutions within the specified range                                                  | [code](../data_juicer/ops/filter/video_resolution_filter.py)             | [tests](../tests/ops/filter/test_video_resolution_filter.py)             |
| video_watermark_filter              | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                             | Keeps samples containing videos with predicted watermark probabilities below the threshold                                                           | [code](../data_juicer/ops/filter/video_watermark_filter.py)              | [tests](../tests/ops/filter/test_video_watermark_filter.py)              |
| video_tagging_from_frames_filter    | ![Multimodal](https://img.shields.io/badge/Multimodal-F25922?style=plastic) ![GPU](https://img.shields.io/badge/GPU-F27649?style=plastic)                                                                                                                                                                                   | Keep samples containing videos with given tags                                                                                                       | [code](../data_juicer/ops/filter/video_tagging_from_frames_filter.py)    | [tests](../tests/ops/filter/test_video_tagging_from_frames_filter.py)    |
| words_num_filter                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with word count within the specified range                                                                                             | [code](../data_juicer/ops/filter/words_num_filter.py)                    | [tests](../tests/ops/filter/test_words_num_filter.py)                    |
| word_repetition_filter              | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic)                                                               | Keeps samples with word-level n-gram repetition ratio within the specified range                                                                     | [code](../data_juicer/ops/filter/word_repetition_filter.py)              | [tests](../tests/ops/filter/test_word_repetition_filter.py)              |

## Deduplicator <a name="deduplicator"/>

| Operator                      | Tags                                                                                                                                                                                                                                                          | Description                                                                                    | Source code                                                              | Unit tests                                                               |
|-------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| document_deduplicator         | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Deduplicates samples at document-level by comparing MD5 hash                                   | [code](../data_juicer/ops/deduplicator/document_deduplicator.py)         | [tests](../tests/ops/deduplicator/test_document_deduplicator.py)         |
| document_minhash_deduplicator | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Deduplicates samples at document-level using MinHashLSH                                        | [code](../data_juicer/ops/deduplicator/document_minhash_deduplicator.py) | [tests](../tests/ops/deduplicator/test_document_minhash_deduplicator.py) |
| document_simhash_deduplicator | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Deduplicates samples at document-level using SimHash                                           | [code](../data_juicer/ops/deduplicator/document_simhash_deduplicator.py) | [tests](../tests/ops/deduplicator/test_document_simhash_deduplicator.py) |
| image_deduplicator            | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                             | Deduplicates samples at document-level using exact matching of images between documents        | [code](../data_juicer/ops/deduplicator/image_deduplicator.py)            | [tests](../tests/ops/deduplicator/test_image_deduplicator.py)            |
| video_deduplicator            | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                             | Deduplicates samples at document-level using exact matching of videos between documents        | [code](../data_juicer/ops/deduplicator/video_deduplicator.py)            | [tests](../tests/ops/deduplicator/test_video_deduplicator.py)            |
| ray_document_deduplicator     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![Text](https://img.shields.io/badge/Text-010326?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Deduplicates samples at document-level by comparing MD5 hash on ray                            | [code](../data_juicer/ops/deduplicator/ray_document_deduplicator.py)     | -                                                                        |
| ray_image_deduplicator        | ![Image](https://img.shields.io/badge/Image-07B0F2?style=plastic)                                                                                                                                                                                             | Deduplicates samples at document-level using exact matching of images between documents on ray | [code](../data_juicer/ops/deduplicator/ray_image_deduplicator.py)        | -                                                                        |
| ray_video_deduplicator        | ![Video](https://img.shields.io/badge/Video-F2B138?style=plastic)                                                                                                                                                                                             | Deduplicates samples at document-level using exact matching of videos between documents on ray | [code](../data_juicer/ops/deduplicator/ray_video_deduplicator.py)        | -                                                                        |

## Selector <a name="selector"/>

| Operator                           | Tags                                                                                                                                                                                          | Description                                                                             | Source code                                                                   | Unit tests                                                                |
|------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------|-------------------------------------------------------------------------------|---------------------------------------------------------------------------|
| frequency_specified_field_selector | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Selects top samples by comparing the frequency of the specified field                   | [code](../data_juicer/ops/selector/frequency_specified_field_selector.py)     | [tests](../tests/ops/selector/test_frequency_specified_field_selector.py) |
| random_selector                    | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Selects samples randomly                                                                | [code](../data_juicer/ops/selector/random_selector.py)                        | [tests](../tests/ops/selector/test_random_selector.py)                    |
| range_specified_field_selector     | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Selects samples within a specified range by comparing the values of the specified field | [code](../data_juicer/ops/selector/range_specified_field_selector.py)         | [tests](../tests/ops/selector/test_range_specified_field_selector.py)     |
| topk_specified_field_selector      | ![General](https://img.shields.io/badge/General-5FBF50?style=plastic) ![en](https://img.shields.io/badge/en-A60D1A?style=plastic) ![zh](https://img.shields.io/badge/zh-F2D6A2?style=plastic) | Selects top samples by comparing the values of the specified field                      | [code](../data_juicer/ops/selector/topk_specified_field_selector.py)          | [tests](../tests/ops/selector/test_topk_specified_field_selector.py)      |


## Contributing
We welcome contributions of adding new operators. Please refer to [How-to Guide for Developers](DeveloperGuide.md).
