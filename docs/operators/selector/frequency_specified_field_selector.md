# frequency_specified_field_selector

Selector to filter samples based on the frequency of a specified field.

This operator selects samples based on the frequency of values in a specified field. The field can be multi-level, with keys separated by dots. It supports filtering by either a top ratio or a fixed number (topk) of the most frequent values. If both top_ratio and topk are provided, the one resulting in fewer samples is used. The sorting order can be controlled with the reverse parameter. The operator processes the dataset and returns a new dataset containing only the selected samples.

é€‰æ‹©å™¨æ ¹æ®æŒ‡å®šå­—æ®µçš„é¢‘ç‡è¿‡æ»¤æ ·æœ¬ã€‚

æ­¤è¿ç®—ç¬¦æ ¹æ®æŒ‡å®šå­—æ®µä¸­å€¼çš„é¢‘ç‡é€‰æ‹©æ ·æœ¬ã€‚è¯¥å­—æ®µå¯ä»¥æ˜¯å¤šçº§çš„ï¼Œé”®ç”±ç‚¹åˆ†éš”ã€‚å®ƒæ”¯æŒæŒ‰æœ€é«˜æ¯”ç‡æˆ–æœ€é¢‘ç¹å€¼çš„å›ºå®šæ•°é‡ (topk) è¿›è¡Œè¿‡æ»¤ã€‚å¦‚æœæä¾›äº†top_ratioå’Œtopkï¼Œåˆ™ä½¿ç”¨äº§ç”Ÿè¾ƒå°‘æ ·æœ¬çš„é‚£ä¸ªã€‚å¯ä»¥ä½¿ç”¨reverseå‚æ•°æ§åˆ¶æ’åºé¡ºåºã€‚è¿ç®—ç¬¦å¤„ç†æ•°æ®é›†å¹¶è¿”å›ä»…åŒ…å«é€‰å®šæ ·æœ¬çš„æ–°æ•°æ®é›†ã€‚

Type ç®—å­ç±»å‹: **selector**

Tags æ ‡ç­¾: cpu

## ğŸ”§ Parameter Configuration å‚æ•°é…ç½®
| name å‚æ•°å | type ç±»å‹ | default é»˜è®¤å€¼ | desc è¯´æ˜ |
|--------|------|--------|------|
| `field_key` | <class 'str'> | `''` | Selector based on the specified value |
| `top_ratio` | typing.Optional[typing.Annotated[float, FieldInfo(annotation=NoneType, required=True, metadata=[Ge(ge=0), Le(le=1)])]] | `None` | Ratio of selected top specified field value, |
| `topk` | typing.Optional[typing.Annotated[int, Gt(gt=0)]] | `None` | Number of selected top specified field value, |
| `reverse` | <class 'bool'> | `True` | Determine the sorting rule, if reverse=True, |
| `args` |  | `''` | extra args |
| `kwargs` |  | `''` | extra args |

## ğŸ“Š Effect demonstration æ•ˆæœæ¼”ç¤º
### test_topratio_select
```python
FrequencySpecifiedFieldSelector(field_key='meta.suffix', top_ratio=0.3, topk=5, reverse=True)
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä¸­æ–‡ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç®—ä¸€ä¸ªé•¿åº¦</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ï¼Œã€‚ã€â€â€â€œÂ«Â»ï¼‘ã€ã€Œã€Šã€‹Â´âˆ¶ï¼šï¼Ÿï¼</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä»–çš„è‹±æ–‡åå­—å«Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 6:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.py&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 89}, &#x27;count&#x27;: 3}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 7:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å‡ºç”Ÿäº2023å¹´12æœˆ15æ—¥</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.java&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 67}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 8:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emojiè¡¨æƒ…æµ‹è¯•ä¸‹ğŸ˜Šï¼ŒğŸ˜¸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 9:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 33}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 10:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä½¿ç”¨ç‰‡æ®µåˆ†è¯å™¨å¯¹æ¯ä¸ªé¡µé¢è¿›è¡Œåˆ†è¯ï¼Œä½¿ç”¨è¯­è¨€</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>666</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.xml&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä»–çš„è‹±æ–‡åå­—å«Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 33}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ï¼Œã€‚ã€â€â€â€œÂ«Â»ï¼‘ã€ã€Œã€Šã€‹Â´âˆ¶ï¼šï¼Ÿï¼</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emojiè¡¨æƒ…æµ‹è¯•ä¸‹ğŸ˜Šï¼ŒğŸ˜¸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div>

#### âœ¨ explanation è§£é‡Š
The operator selects samples based on the frequency of 'meta.suffix' field, using a top ratio of 0.3 and a topk of 5, with reverse sorting. The target list contains the most frequent suffixes, '.pdf' and '.html', according to the specified criteria, while others are removed.
ç®—å­æ ¹æ®'meta.suffix'å­—æ®µçš„é¢‘ç‡é€‰æ‹©æ ·æœ¬ï¼Œä½¿ç”¨0.3çš„é¡¶éƒ¨æ¯”ä¾‹å’Œ5çš„topkï¼Œå¹¶æŒ‰é™åºæ’åˆ—ã€‚ç›®æ ‡åˆ—è¡¨åŒ…å«æ ¹æ®æŒ‡å®šæ ‡å‡†æœ€é¢‘ç¹çš„åç¼€'.pdf'å’Œ'.html'ï¼Œè€Œå…¶ä»–åˆ™è¢«ç§»é™¤ã€‚

### test_reverse_select
```python
FrequencySpecifiedFieldSelector(field_key='meta.key1.key2.count', top_ratio=0.4, topk=2, reverse=False)
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä¸­æ–‡ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç®—ä¸€ä¸ªé•¿åº¦</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ï¼Œã€‚ã€â€â€â€œÂ«Â»ï¼‘ã€ã€Œã€Šã€‹Â´âˆ¶ï¼šï¼Ÿï¼</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä»–çš„è‹±æ–‡åå­—å«Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 6:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.py&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 89}, &#x27;count&#x27;: 3}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 7:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å‡ºç”Ÿäº2023å¹´12æœˆ15æ—¥</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.java&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 67}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 8:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emojiè¡¨æƒ…æµ‹è¯•ä¸‹ğŸ˜Šï¼ŒğŸ˜¸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 9:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 10:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä½¿ç”¨ç‰‡æ®µåˆ†è¯å™¨å¯¹æ¯ä¸ªé¡µé¢è¿›è¡Œåˆ†è¯ï¼Œä½¿ç”¨è¯­è¨€</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>666</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.xml&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä¸­æ–‡ä¹Ÿæ˜¯ä¸€ä¸ªå­—ç®—ä¸€ä¸ªé•¿åº¦</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div>

#### âœ¨ explanation è§£é‡Š
This example demonstrates the use of the operator with reverse set to False, selecting the least frequent values in the 'meta.key1.key2.count' field. Only two samples with the least frequent or null values in this field are kept, while all others are removed.
æ­¤ç¤ºä¾‹å±•ç¤ºäº†å°†reverseè®¾ç½®ä¸ºFalseæ—¶ç®—å­çš„ä½¿ç”¨æƒ…å†µï¼Œé€‰æ‹©'meta.key1.key2.count'å­—æ®µä¸­æœ€ä¸é¢‘ç¹çš„å€¼ã€‚ä»…ä¿ç•™è¯¥å­—æ®µä¸­å€¼æœ€ä¸é¢‘ç¹æˆ–ä¸ºç©ºçš„ä¸¤ä¸ªæ ·æœ¬ï¼Œå…¶ä½™å…¨éƒ¨è¢«ç§»é™¤ã€‚


## ğŸ”— related links ç›¸å…³é“¾æ¥
- [source code æºä»£ç ](../../../data_juicer/ops/selector/frequency_specified_field_selector.py)
- [unit test å•å…ƒæµ‹è¯•](../../../tests/ops/selector/test_frequency_specified_field_selector.py)
- [Return operator list è¿”å›ç®—å­åˆ—è¡¨](../../Operators.md)