# frequency_specified_field_selector

Selector to filter samples based on the frequency of a specified field.

This operator selects samples based on the frequency of values in a specified field. The field can be multi-level, with keys separated by dots. It supports filtering by either a top ratio or a fixed number (topk) of the most frequent values. If both top_ratio and topk are provided, the one resulting in fewer samples is used. The sorting order can be controlled with the reverse parameter. The operator processes the dataset and returns a new dataset containing only the selected samples.

选择器根据指定字段的频率过滤样本。

此运算符根据指定字段中值的频率选择样本。该字段可以是多级的，键由点分隔。它支持按最高比率或最频繁值的固定数量 (topk) 进行过滤。如果提供了top_ratio和topk，则使用产生较少样本的那个。可以使用reverse参数控制排序顺序。运算符处理数据集并返回仅包含选定样本的新数据集。

Type 算子类型: **selector**

Tags 标签: cpu

## 🔧 Parameter Configuration 参数配置
| name 参数名 | type 类型 | default 默认值 | desc 说明 |
|--------|------|--------|------|
| `field_key` | <class 'str'> | `''` | Selector based on the specified value |
| `top_ratio` | typing.Optional[typing.Annotated[float, FieldInfo(annotation=NoneType, required=True, metadata=[Ge(ge=0), Le(le=1)])]] | `None` | Ratio of selected top specified field value, |
| `topk` | typing.Optional[typing.Annotated[int, Gt(gt=0)]] | `None` | Number of selected top specified field value, |
| `reverse` | <class 'bool'> | `True` | Determine the sorting rule, if reverse=True, |
| `args` |  | `''` | extra args |
| `kwargs` |  | `''` | extra args |

## 📊 Effect demonstration 效果演示
### test_topratio_select
```python
FrequencySpecifiedFieldSelector(field_key='meta.suffix', top_ratio=0.3, topk=5, reverse=True)
```

#### 📥 input data 输入数据
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">中文也是一个字算一个长度</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">，。、„”“«»１」「《》´∶：？！</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">他的英文名字叫Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 6:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">这是一个测试</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.py&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 89}, &#x27;count&#x27;: 3}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 7:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">我出生于2023年12月15日</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.java&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 67}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 8:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emoji表情测试下😊，😸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 9:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 33}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 10:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">使用片段分词器对每个页面进行分词，使用语言</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>666</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.xml&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div>

#### 📤 output data 输出数据
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">他的英文名字叫Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 33}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">，。、„”“«»１」「《》´∶：？！</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emoji表情测试下😊，😸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div>

#### ✨ explanation 解释
The operator selects samples based on the frequency of 'meta.suffix' field, using a top ratio of 0.3 and a topk of 5, with reverse sorting. The target list contains the most frequent suffixes, '.pdf' and '.html', according to the specified criteria, while others are removed.
算子根据'meta.suffix'字段的频率选择样本，使用0.3的顶部比例和5的topk，并按降序排列。目标列表包含根据指定标准最频繁的后缀'.pdf'和'.html'，而其他则被移除。

### test_reverse_select
```python
FrequencySpecifiedFieldSelector(field_key='meta.key1.key2.count', top_ratio=0.4, topk=2, reverse=False)
```

#### 📥 input data 输入数据
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Today is Sun</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>101</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 5}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">中文也是一个字算一个长度</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">，。、„”“«»１」「《》´∶：？！</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 48}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 5:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">他的英文名字叫Harry Potter</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>88</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 551}, &#x27;count&#x27;: 78}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 6:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">这是一个测试</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.py&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 89}, &#x27;count&#x27;: 3}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 7:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">我出生于2023年12月15日</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>None</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.java&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 67}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 8:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">emoji表情测试下😊，😸31231
</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>2</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.html&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 354.32}, &#x27;count&#x27;: 32}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 9:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a=1
b
c=1+2+3+5
d=6</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>178</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.pdf&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 34}, &#x27;count&#x27;: 33}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 10:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">使用片段分词器对每个页面进行分词，使用语言</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>666</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.xml&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 18}, &#x27;count&#x27;: 48}}</td></tr></table></div></div>

#### 📤 output data 输出数据
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">a v s e c s f e f g a a a  </pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>16</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.docx&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: 243}, &#x27;count&#x27;: 63}}</td></tr></table></div></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">中文也是一个字算一个长度</pre><div class='meta' style='margin-top:6px;'><table style='border-collapse:collapse; margin-top:6px;'><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>count</td><td style='padding:4px 8px;'>162</td></tr><tr><td style='padding:4px 8px; color:#555; white-space:nowrap;'>meta</td><td style='padding:4px 8px;'>{&#x27;suffix&#x27;: &#x27;.txt&#x27;, &#x27;key1&#x27;: {&#x27;key2&#x27;: {&#x27;count&#x27;: None}, &#x27;count&#x27;: 23}}</td></tr></table></div></div>

#### ✨ explanation 解释
This example demonstrates the use of the operator with reverse set to False, selecting the least frequent values in the 'meta.key1.key2.count' field. Only two samples with the least frequent or null values in this field are kept, while all others are removed.
此示例展示了将reverse设置为False时算子的使用情况，选择'meta.key1.key2.count'字段中最不频繁的值。仅保留该字段中值最不频繁或为空的两个样本，其余全部被移除。


## 🔗 related links 相关链接
- [source code 源代码](../../../data_juicer/ops/selector/frequency_specified_field_selector.py)
- [unit test 单元测试](../../../tests/ops/selector/test_frequency_specified_field_selector.py)
- [Return operator list 返回算子列表](../../Operators.md)