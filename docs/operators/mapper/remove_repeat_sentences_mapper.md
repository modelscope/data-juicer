# remove_repeat_sentences_mapper

Mapper to remove repeat sentences in text samples.

This operator processes text samples to remove duplicate sentences. It splits the text
into lines and then further splits each line into sentences. Sentences are considered
duplicates if they are identical after optional case normalization and special character
removal. The operator uses a hash set to track unique sentences. Sentences shorter than
`min_repeat_sentence_length` are not deduplicated. If `ignore_special_character` is
enabled, special characters (all except Chinese, letters, and numbers) are ignored when
checking for duplicates. The resulting text is reassembled with unique sentences.

Type ç®—å­ç±»å‹: **mapper**

Tags æ ‡ç­¾: cpu, text

## ğŸ”§ Parameter Configuration å‚æ•°é…ç½®
| name å‚æ•°å | type ç±»å‹ | default é»˜è®¤å€¼ | desc è¯´æ˜ |
|--------|------|--------|------|
| `lowercase` | <class 'bool'> | `False` | Whether to convert sample text to lower case |
| `ignore_special_character` | <class 'bool'> | `True` | Whether to ignore special |
| `min_repeat_sentence_length` | <class 'int'> | `2` | Sentences shorter than this |
| `args` |  | `''` | extra args |
| `kwargs` |  | `''` | extra args |

## ğŸ“Š Effect demonstration æ•ˆæœæ¼”ç¤º
### test_text
```python
RemoveRepeatSentencesMapper()
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚å°æ˜è¯´ï¼šâ€œä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œæˆ‘ä»¬å»æµ·è¾¹å§ã€‚â€ å°çº¢å›ç­”è¯´ï¼šâ€œå¥½ä¸»æ„ï¼â€ ä½†æ˜¯ï¼Œå°æè§‰å¾—ï¼šâ€œä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œæˆ‘ä»¬å»çˆ¬å±±å§ã€‚â€ ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚æ˜¨å¤©ä¸‹äº†ä¸€æ•´å¤©çš„é›¨ï¼Œä»Šå¤©ç»ˆäºæ”¾æ™´äº†ã€‚æ˜¨å¤©ä¸‹äº†ä¸€æ•´å¤©çš„é›¨ï¼Œä»Šå¤©ç»ˆäºæ”¾æ™´äº†ã€‚</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">The quick brown fox jumps over the lazy dog. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? The quick brown fox jumps over the lazy dog. Speaking of weather, yesterday was quite dreary; however, today is absolutely delightful. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm. &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm.</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å¾ˆå¼€å¿ƒ ã€‚ä½†æ˜¯ä½ ä¸å¼€å¿ƒ  ã€‚æˆ‘å¾ˆå¼€å¿ƒ ã€‚
ä½ å¥½å‘€ï¼æˆ‘å¾ˆå¼€å¿ƒ ã€‚æˆ‘å¥½çš„ã€‚ä½ å¥½å‘€ï¼</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">é»˜è®¤é…ç½®ä¸‹ï¼Œé•¿åº¦ä½äº2çš„å¥å­ä¸ä¼šè¢«å»é‡ã€‚å»é‡ï¼Ÿå»é‡ã€‚å»é‡ï¼é‡ã€‚é‡...... é‡! 1234ï¼Ÿ3215. 1234. 3. 3. 3</pre></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚å°æ˜è¯´ï¼šâ€œä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œæˆ‘ä»¬å»æµ·è¾¹å§ã€‚â€ å°çº¢å›ç­”è¯´ï¼šâ€œå¥½ä¸»æ„ï¼â€ ä½†æ˜¯ï¼Œå°æè§‰å¾—ï¼šâ€œä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œæˆ‘ä»¬å»çˆ¬å±±å§ã€‚â€æ˜¨å¤©ä¸‹äº†ä¸€æ•´å¤©çš„é›¨ï¼Œä»Šå¤©ç»ˆäºæ”¾æ™´äº†ã€‚</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">The quick brown fox jumps over the lazy dog. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? Speaking of weather, yesterday was quite dreary; however, today is absolutely delightful. &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm.</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å¾ˆå¼€å¿ƒ ã€‚ä½†æ˜¯ä½ ä¸å¼€å¿ƒ  ã€‚
ä½ å¥½å‘€ï¼æˆ‘å¥½çš„ã€‚</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">é»˜è®¤é…ç½®ä¸‹ï¼Œé•¿åº¦ä½äº2çš„å¥å­ä¸ä¼šè¢«å»é‡ã€‚å»é‡ï¼Ÿé‡ã€‚é‡...... é‡! 1234ï¼Ÿ3215. 3. 3. 3</pre></div>

#### âœ¨ explanation è§£é‡Š
This example demonstrates the basic functionality of the operator, which removes repeated sentences from the input text. The operator splits the text into sentences and compares them to find duplicates. In the first sample, the sentence 'ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚' and 'æ˜¨å¤©ä¸‹äº†ä¸€æ•´å¤©çš„é›¨ï¼Œä»Šå¤©ç»ˆäºæ”¾æ™´äº†ã€‚' are removed because they appear more than once. Similarly, in the English sample, 'The quick brown fox jumps over the lazy dog.' and 'Isn't it amazing how a simple sentence can contain every letter of the alphabet?' are removed for being duplicates. The output data is the original output of the operator, showing the text with duplicate sentences removed.
è¿™ä¸ªä¾‹å­å±•ç¤ºäº†ç®—å­çš„åŸºæœ¬åŠŸèƒ½ï¼Œå³ä»è¾“å…¥æ–‡æœ¬ä¸­ç§»é™¤é‡å¤çš„å¥å­ã€‚ç®—å­å°†æ–‡æœ¬æ‹†åˆ†æˆå¥å­å¹¶è¿›è¡Œæ¯”è¾ƒä»¥æ‰¾å‡ºé‡å¤é¡¹ã€‚åœ¨ç¬¬ä¸€ä¸ªæ ·æœ¬ä¸­ï¼Œå¥å­'ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œé€‚åˆå‡ºå»æ•£æ­¥ã€‚'å’Œ'æ˜¨å¤©ä¸‹äº†ä¸€æ•´å¤©çš„é›¨ï¼Œä»Šå¤©ç»ˆäºæ”¾æ™´äº†ã€‚'å› ä¸ºå‡ºç°äº†å¤šæ¬¡è€Œè¢«ç§»é™¤ã€‚åŒæ ·ï¼Œåœ¨è‹±æ–‡æ ·æœ¬ä¸­ï¼Œ'The quick brown fox jumps over the lazy dog.'å’Œ'Isn't it amazing how a simple sentence can contain every letter of the alphabet?'ä½œä¸ºé‡å¤é¡¹è¢«ç§»é™¤ã€‚è¾“å‡ºæ•°æ®æ˜¯ç®—å­çš„åŸå§‹è¾“å‡ºï¼Œæ˜¾ç¤ºäº†å»é™¤äº†é‡å¤å¥å­åçš„æ–‡æœ¬ã€‚

### test_text2
```python
RemoveRepeatSentencesMapper(lowercase=True, ignore_special_character=False, min_repeat_sentence_length=5)
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Life is what happens when you&#x27;re busy making other plans. John Lennon once said. Life is what happens when you&#x27;re busy making other plans. This phrase has resonated with many people over the years. äººç”Ÿå°±æ˜¯å½“ä½ å¿™äºåˆ¶å®šå…¶ä»–è®¡åˆ’æ—¶å‘ç”Ÿçš„äº‹æƒ…ã€‚å¯¹å¾ˆå¤šäººæ¥è¯´ï¼Œè¿™å¥è¯å¼•èµ·äº†å…±é¸£ã€‚</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">The quick brown fox jumps over the lazy dog. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? The quick brown fox jumps over the lazy dog. Speaking of weather, yesterday was quite dreary; however, today is absolutely delightful. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm. &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm.</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å¾ˆå¼€å¿ƒ ã€‚ä½†æ˜¯ä½ ä¸å¼€å¿ƒ  ã€‚æˆ‘å¾ˆå¼€å¿ƒ ã€‚
ä½ å¥½å‘€ï¼æˆ‘å¾ˆå¼€å¿ƒ ã€‚æˆ‘å¥½çš„ã€‚ä½ å¥½å‘€ï¼</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">å»é‡ï¼Ÿå»é‡ã€‚å»é‡ï¼é‡ã€‚é‡...... é‡! 1234ï¼Ÿ3215. 1234. 3. 3. 3</pre></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">Life is what happens when you&#x27;re busy making other plans. John Lennon once said. This phrase has resonated with many people over the years. äººç”Ÿå°±æ˜¯å½“ä½ å¿™äºåˆ¶å®šå…¶ä»–è®¡åˆ’æ—¶å‘ç”Ÿçš„äº‹æƒ…ã€‚å¯¹å¾ˆå¤šäººæ¥è¯´ï¼Œè¿™å¥è¯å¼•èµ·äº†å…±é¸£ã€‚</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 2:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">The quick brown fox jumps over the lazy dog. Isn&#x27;t it amazing how a simple sentence can contain every letter of the alphabet? Speaking of weather, yesterday was quite dreary; however, today is absolutely delightful. &quot;Let&#x27;s seize the day,&quot; Tom exclaimed, full of enthusiasm.</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 3:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">æˆ‘å¾ˆå¼€å¿ƒ ã€‚ä½†æ˜¯ä½ ä¸å¼€å¿ƒ  ã€‚
ä½ å¥½å‘€ï¼æˆ‘å¥½çš„ã€‚ä½ å¥½å‘€ï¼</pre></div><div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 4:</strong> text</div><pre style="padding:6px; background:#f6f8fa; border-radius:4px; overflow-x:auto; white-space:pre; word-wrap:normal;">å»é‡ï¼Ÿå»é‡ã€‚å»é‡ï¼é‡ã€‚é‡...... é‡! 1234ï¼Ÿ3215. 1234. 3. 3. 3</pre></div>

#### âœ¨ explanation è§£é‡Š
This example illustrates the operator's behavior when additional parameters are set: `lowercase=True`, `ignore_special_character=False`, and `min_repeat_sentence_length=5`. With these settings, the operator will convert all sentences to lowercase before comparing them, but it will not ignore special characters. Also, only sentences longer than 4 characters (since `min_repeat_sentence_length` is 5) will be considered for deduplication. In the first sample, the sentence 'Life is what happens when you're busy making other plans.' is removed as a duplicate, while in the Chinese part, no sentences are removed because they do not meet the length requirement. The output data is the original output of the operator, showing the text after applying these specific configurations.
è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å½“è®¾ç½®é¢å¤–å‚æ•°æ—¶ç®—å­çš„è¡Œä¸ºï¼š`lowercase=True`ã€`ignore_special_character=False` å’Œ `min_repeat_sentence_length=5`ã€‚ä½¿ç”¨è¿™äº›è®¾ç½®ï¼Œç®—å­ä¼šåœ¨æ¯”è¾ƒå‰å°†æ‰€æœ‰å¥å­è½¬æ¢ä¸ºå°å†™ï¼Œä½†ä¸ä¼šå¿½ç•¥ç‰¹æ®Šå­—ç¬¦ã€‚åŒæ—¶ï¼Œåªæœ‰é•¿åº¦è¶…è¿‡4ä¸ªå­—ç¬¦ï¼ˆå› ä¸º`min_repeat_sentence_length`æ˜¯5ï¼‰çš„å¥å­æ‰ä¼šè¢«è€ƒè™‘å»é‡ã€‚åœ¨ç¬¬ä¸€ä¸ªæ ·æœ¬ä¸­ï¼Œå¥å­'Life is what happens when you're busy making other plans.'ä½œä¸ºé‡å¤é¡¹è¢«ç§»é™¤ï¼Œè€Œåœ¨ä¸­æ–‡éƒ¨åˆ†ï¼Œæ²¡æœ‰å¥å­è¢«ç§»é™¤ï¼Œå› ä¸ºå®ƒä»¬ä¸ç¬¦åˆé•¿åº¦è¦æ±‚ã€‚è¾“å‡ºæ•°æ®æ˜¯ç®—å­çš„åŸå§‹è¾“å‡ºï¼Œæ˜¾ç¤ºäº†åº”ç”¨è¿™äº›ç‰¹å®šé…ç½®åçš„æ–‡æœ¬ã€‚


## ğŸ”— related links ç›¸å…³é“¾æ¥
- [source code æºä»£ç ](../../../data_juicer/ops/mapper/remove_repeat_sentences_mapper.py)
- [unit test å•å…ƒæµ‹è¯•](../../../tests/ops/mapper/test_remove_repeat_sentences_mapper.py)
- [Return operator list è¿”å›ç®—å­åˆ—è¡¨](../../Operators.md)