# entity_attribute_aggregator

Summarizes a given attribute of an entity from a set of documents.

The operator extracts and summarizes the specified attribute of a given entity from the provided documents. It uses a system prompt, example prompt, and input template to generate the summary. The output is formatted as a markdown-style summary with the entity and attribute clearly labeled. The summary is limited to a specified number of words (default is 100). The operator uses a Hugging Face tokenizer to handle token limits and splits documents if necessary. If the input key or required fields are missing, the operator logs a warning and returns the sample unchanged. The summary is stored in the batch metadata under the specified output key. The system prompt, input template, example prompt, and output pattern can be customized.

ä»ä¸€ç»„æ–‡æ¡£ä¸­æå–å¹¶æ€»ç»“ç»™å®šå®ä½“çš„ç‰¹å®šå±æ€§ã€‚

è¯¥ç®—å­ä»æä¾›çš„æ–‡æ¡£ä¸­æå–å¹¶æ€»ç»“ç»™å®šå®ä½“çš„æŒ‡å®šå±æ€§ã€‚å®ƒä½¿ç”¨ç³»ç»Ÿæç¤ºã€ç¤ºä¾‹æç¤ºå’Œè¾“å…¥æ¨¡æ¿ç”Ÿæˆæ‘˜è¦ã€‚è¾“å‡ºæ ¼å¼ä¸º markdown é£æ ¼çš„æ‘˜è¦ï¼Œå…¶ä¸­å®ä½“å’Œå±æ€§æ¸…æ™°æ ‡æ³¨ã€‚æ‘˜è¦é™åˆ¶åœ¨æŒ‡å®šçš„å•è¯æ•°å†…ï¼ˆé»˜è®¤ä¸º 100 ä¸ªå•è¯ï¼‰ã€‚è¯¥ç®—å­ä½¿ç”¨ Hugging Face åˆ†è¯å™¨æ¥å¤„ç† token é™åˆ¶ï¼Œå¹¶åœ¨å¿…è¦æ—¶åˆ†å‰²æ–‡æ¡£ã€‚å¦‚æœç¼ºå°‘è¾“å…¥é”®æˆ–å¿…å¡«å­—æ®µï¼Œè¯¥ç®—å­ä¼šè®°å½•è­¦å‘Šå¹¶è¿”å›æœªæ›´æ”¹çš„æ ·æœ¬ã€‚æ‘˜è¦å­˜å‚¨åœ¨æ‰¹å¤„ç†å…ƒæ•°æ®ä¸­çš„æŒ‡å®šè¾“å‡ºé”®ä¸‹ã€‚ç³»ç»Ÿæç¤ºã€è¾“å…¥æ¨¡æ¿ã€ç¤ºä¾‹æç¤ºå’Œè¾“å‡ºæ¨¡å¼å¯ä»¥è‡ªå®šä¹‰ã€‚

Type ç®—å­ç±»å‹: **aggregator**

Tags æ ‡ç­¾: cpu, api

## ğŸ”§ Parameter Configuration å‚æ•°é…ç½®
| name å‚æ•°å | type ç±»å‹ | default é»˜è®¤å€¼ | desc è¯´æ˜ |
|--------|------|--------|------|
| `api_model` | <class 'str'> | `'gpt-4o'` | API model name. |
| `entity` | <class 'str'> | `None` | The given entity. |
| `attribute` | <class 'str'> | `None` | The given attribute. |
| `input_key` | <class 'str'> | `'event_description'` | The input key in the meta field of the samples. It is "event_description" in default. |
| `output_key` | <class 'str'> | `'entity_attribute'` | The output key in the aggregation field of the samples. It is "entity_attribute" in default. |
| `word_limit` | typing.Annotated[int, Gt(gt=0)] | `100` | Prompt the output length. |
| `max_token_num` | typing.Optional[typing.Annotated[int, Gt(gt=0)]] | `None` | The max token num of the total tokens of the sub documents. Without limitation if it is None. |
| `api_endpoint` | typing.Optional[str] | `None` | URL endpoint for the API. |
| `response_path` | typing.Optional[str] | `None` | Path to extract content from the API response. Defaults to 'choices.0.message.content'. |
| `system_prompt_template` | typing.Optional[str] | `None` | The system prompt template. |
| `example_prompt` | typing.Optional[str] | `None` | The example part in the system prompt. |
| `input_template` | typing.Optional[str] | `None` | The input template. |
| `output_pattern_template` | typing.Optional[str] | `None` | The output template. |
| `try_num` | typing.Annotated[int, Gt(gt=0)] | `3` | The number of retry attempts when there is an API call error or output parsing error. |
| `model_params` | typing.Dict | `{}` | Parameters for initializing the API model. |
| `sampling_params` | typing.Dict | `{}` | Extra parameters passed to the API call. e.g {'temperature': 0.9, 'top_p': 0.95} |
| `kwargs` |  | `''` | Extra keyword arguments. |

## ğŸ“Š Effect demonstration æ•ˆæœæ¼”ç¤º
### test_default_aggregator
```python
EntityAttributeAggregator(api_model='qwen2.5-72b-instruct', entity='æè²èŠ±', attribute='ä¸»è¦ç»å†')
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> empty</div><div class='meta' style='margin:6px 0;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__meta__</th></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´å‰ï¼Œæç›¸å¤·åäº”å²æˆ˜èƒœè¥¿åŸŸå¤©é­”æˆä¸ºå¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ï¼Œåä¸ƒå²å»ºç«‹å››é¡¾é—¨ï¼ŒäºŒåå²é—®é¼æ­¦æ—ç›Ÿä¸»ï¼Œæˆä¸ºä¼ å¥‡äººç‰©ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>æœ‰äººè§†æç›¸å¤·ä¸ºä¸­åŸæ­¦æ—çš„å¸Œæœ›ï¼Œä½†ä¹Ÿæœ‰äººä»¥æˆ˜èƒœä»–ä¸ºç›®æ ‡ï¼ŒåŒ…æ‹¬é­”æ•™é‡‘é¸³ç›Ÿç›Ÿä¸»ç¬›é£å£°ã€‚ç¬›é£å£°è®¾è®¡åŠ å®³æç›¸å¤·çš„å¸ˆå…„å•å­¤åˆ€ï¼Œå¼•å¾—æç›¸å¤·ä¸ä¹‹ä¸€æˆ˜ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åœ¨ä¸œæµ·çš„ä¸€è‰˜èˆ¹ä¸Šï¼Œæç›¸å¤·ç‹¬è‡ªä¸€äººå¯¹æŠ—é‡‘é¸³ç›Ÿçš„é«˜æ‰‹ï¼Œæœ€ç»ˆå‡»è´¥äº†å¤§éƒ¨åˆ†æ•Œäººã€‚ç¬›é£å£°çªç„¶å‡ºç°ï¼Œä¸¤äººæ¿€æˆ˜ï¼Œæç›¸å¤·åœ¨æˆ˜æ–—ä¸­ä¸­æ¯’ï¼Œæœ€ç»ˆè¢«ç¬›é£å£°é‡ä¼¤ï¼Œèˆ¹åªçˆ†ç‚¸ï¼Œæç›¸å¤·æ²‰å…¥å¤§æµ·ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´åï¼Œæè²èŠ±åœ¨ä¸€ä¸ªå¯’é…¸çš„è²èŠ±æ¥¼å†…é†’æ¥ï¼Œè¡¨ç°å‡ºä¸æç›¸å¤·æˆªç„¶ä¸åŒçš„æ€§æ ¼ã€‚ä»–ä»¥ç¥åŒ»çš„èº«ä»½åœ¨å°é•‡ä¸Šè¡ŒåŒ»ï¼Œä½†ç”Ÿæ´»è´«å›°ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>å°é•‡ä¸Šçš„çš®å½±æˆæ‘Šè®²è¿°æç›¸å¤·å’Œç¬›é£å£°çš„æ•…äº‹ï¼Œå­©å­ä»¬äº‰è®ºè°èµ¢äº†ã€‚é£ç«å ‚ç®¡äº‹å¸¦ç€äººæ¥æ‰¾æè²èŠ±ï¼Œè¦æ±‚ä»–æ•‘æ²»ä¸€ä¸ªâ€œæ­»äººâ€ã€‚</td></tr></table></div></td></tr></table></div></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> empty</div><div class='meta' style='margin:6px 0;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__meta__</th></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´å‰ï¼Œæç›¸å¤·åäº”å²æˆ˜èƒœè¥¿åŸŸå¤©é­”æˆä¸ºå¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ï¼Œåä¸ƒå²å»ºç«‹å››é¡¾é—¨ï¼ŒäºŒåå²é—®é¼æ­¦æ—ç›Ÿä¸»ï¼Œæˆä¸ºä¼ å¥‡äººç‰©ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>æœ‰äººè§†æç›¸å¤·ä¸ºä¸­åŸæ­¦æ—çš„å¸Œæœ›ï¼Œä½†ä¹Ÿæœ‰äººä»¥æˆ˜èƒœä»–ä¸ºç›®æ ‡ï¼ŒåŒ…æ‹¬é­”æ•™é‡‘é¸³ç›Ÿç›Ÿä¸»ç¬›é£å£°ã€‚ç¬›é£å£°è®¾è®¡åŠ å®³æç›¸å¤·çš„å¸ˆå…„å•å­¤åˆ€ï¼Œå¼•å¾—æç›¸å¤·ä¸ä¹‹ä¸€æˆ˜ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åœ¨ä¸œæµ·çš„ä¸€è‰˜èˆ¹ä¸Šï¼Œæç›¸å¤·ç‹¬è‡ªä¸€äººå¯¹æŠ—é‡‘é¸³ç›Ÿçš„é«˜æ‰‹ï¼Œæœ€ç»ˆå‡»è´¥äº†å¤§éƒ¨åˆ†æ•Œäººã€‚ç¬›é£å£°çªç„¶å‡ºç°ï¼Œä¸¤äººæ¿€æˆ˜ï¼Œæç›¸å¤·åœ¨æˆ˜æ–—ä¸­ä¸­æ¯’ï¼Œæœ€ç»ˆè¢«ç¬›é£å£°é‡ä¼¤ï¼Œèˆ¹åªçˆ†ç‚¸ï¼Œæç›¸å¤·æ²‰å…¥å¤§æµ·ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´åï¼Œæè²èŠ±åœ¨ä¸€ä¸ªå¯’é…¸çš„è²èŠ±æ¥¼å†…é†’æ¥ï¼Œè¡¨ç°å‡ºä¸æç›¸å¤·æˆªç„¶ä¸åŒçš„æ€§æ ¼ã€‚ä»–ä»¥ç¥åŒ»çš„èº«ä»½åœ¨å°é•‡ä¸Šè¡ŒåŒ»ï¼Œä½†ç”Ÿæ´»è´«å›°ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>å°é•‡ä¸Šçš„çš®å½±æˆæ‘Šè®²è¿°æç›¸å¤·å’Œç¬›é£å£°çš„æ•…äº‹ï¼Œå­©å­ä»¬äº‰è®ºè°èµ¢äº†ã€‚é£ç«å ‚ç®¡äº‹å¸¦ç€äººæ¥æ‰¾æè²èŠ±ï¼Œè¦æ±‚ä»–æ•‘æ²»ä¸€ä¸ªâ€œæ­»äººâ€ã€‚</td></tr></table></div></td></tr><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__batch_meta__</th></tr><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>entity_attribute</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>æè²èŠ±åŸåæç›¸å¤·ï¼Œåäº”å²æˆ˜èƒœè¥¿åŸŸå¤©é­”æˆä¸ºå¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ï¼Œåä¸ƒå²å»ºç«‹å››é¡¾é—¨ï¼ŒäºŒåå²é—®é¼æ­¦æ—ç›Ÿä¸»ã€‚åå› ä¸é­”æ•™é‡‘é¸³ç›Ÿç›Ÿä¸»ç¬›é£å£°æ¿€æˆ˜ä¸­æ¯’é‡ä¼¤ï¼Œèˆ¹åªçˆ†ç‚¸æ²‰æµ·ã€‚åå¹´åï¼Œä»–åœ¨å¯’é…¸çš„è²èŠ±æ¥¼å†…é†’æ¥ï¼Œä»¥ç¥åŒ»èº«ä»½åœ¨å°é•‡ä¸Šè¡ŒåŒ»ï¼Œç”Ÿæ´»è´«å›°ã€‚</td></tr></table></div></div>

#### âœ¨ explanation è§£é‡Š
This example demonstrates the default behavior of the operator, which summarizes the main experiences of the character 'æè²èŠ±' from a set of documents. The output is a summary that includes key events in the life of 'æè²èŠ±', such as his early achievements and later life as a doctor. The summary is stored under the 'entity_attribute' key in the batch metadata.
æ­¤ç¤ºä¾‹å±•ç¤ºäº†ç®—å­çš„é»˜è®¤è¡Œä¸ºï¼Œä»ä¸€ç»„æ–‡æ¡£ä¸­æ€»ç»“è§’è‰²'æè²èŠ±'çš„ä¸»è¦ç»å†ã€‚è¾“å‡ºæ˜¯ä¸€ä¸ªæ‘˜è¦ï¼ŒåŒ…æ‹¬'æè²èŠ±'ç”Ÿæ´»ä¸­çš„å…³é”®äº‹ä»¶ï¼Œå¦‚ä»–æ—©æœŸçš„æˆå°±å’Œåæ¥ä½œä¸ºåŒ»ç”Ÿçš„ç”Ÿæ´»ã€‚è¯¥æ‘˜è¦å­˜å‚¨åœ¨æ‰¹æ¬¡å…ƒæ•°æ®çš„'entity_attribute'é”®ä¸‹ã€‚

### test_word_limit_num
```python
EntityAttributeAggregator(api_model='qwen2.5-72b-instruct', entity='æè²èŠ±', attribute='èº«ä»½èƒŒæ™¯', word_limit=20)
```

#### ğŸ“¥ input data è¾“å…¥æ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> empty</div><div class='meta' style='margin:6px 0;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__meta__</th></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´å‰ï¼Œæç›¸å¤·åäº”å²æˆ˜èƒœè¥¿åŸŸå¤©é­”æˆä¸ºå¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ï¼Œåä¸ƒå²å»ºç«‹å››é¡¾é—¨ï¼ŒäºŒåå²é—®é¼æ­¦æ—ç›Ÿä¸»ï¼Œæˆä¸ºä¼ å¥‡äººç‰©ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>æœ‰äººè§†æç›¸å¤·ä¸ºä¸­åŸæ­¦æ—çš„å¸Œæœ›ï¼Œä½†ä¹Ÿæœ‰äººä»¥æˆ˜èƒœä»–ä¸ºç›®æ ‡ï¼ŒåŒ…æ‹¬é­”æ•™é‡‘é¸³ç›Ÿç›Ÿä¸»ç¬›é£å£°ã€‚ç¬›é£å£°è®¾è®¡åŠ å®³æç›¸å¤·çš„å¸ˆå…„å•å­¤åˆ€ï¼Œå¼•å¾—æç›¸å¤·ä¸ä¹‹ä¸€æˆ˜ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åœ¨ä¸œæµ·çš„ä¸€è‰˜èˆ¹ä¸Šï¼Œæç›¸å¤·ç‹¬è‡ªä¸€äººå¯¹æŠ—é‡‘é¸³ç›Ÿçš„é«˜æ‰‹ï¼Œæœ€ç»ˆå‡»è´¥äº†å¤§éƒ¨åˆ†æ•Œäººã€‚ç¬›é£å£°çªç„¶å‡ºç°ï¼Œä¸¤äººæ¿€æˆ˜ï¼Œæç›¸å¤·åœ¨æˆ˜æ–—ä¸­ä¸­æ¯’ï¼Œæœ€ç»ˆè¢«ç¬›é£å£°é‡ä¼¤ï¼Œèˆ¹åªçˆ†ç‚¸ï¼Œæç›¸å¤·æ²‰å…¥å¤§æµ·ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´åï¼Œæè²èŠ±åœ¨ä¸€ä¸ªå¯’é…¸çš„è²èŠ±æ¥¼å†…é†’æ¥ï¼Œè¡¨ç°å‡ºä¸æç›¸å¤·æˆªç„¶ä¸åŒçš„æ€§æ ¼ã€‚ä»–ä»¥ç¥åŒ»çš„èº«ä»½åœ¨å°é•‡ä¸Šè¡ŒåŒ»ï¼Œä½†ç”Ÿæ´»è´«å›°ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>å°é•‡ä¸Šçš„çš®å½±æˆæ‘Šè®²è¿°æç›¸å¤·å’Œç¬›é£å£°çš„æ•…äº‹ï¼Œå­©å­ä»¬äº‰è®ºè°èµ¢äº†ã€‚é£ç«å ‚ç®¡äº‹å¸¦ç€äººæ¥æ‰¾æè²èŠ±ï¼Œè¦æ±‚ä»–æ•‘æ²»ä¸€ä¸ªâ€œæ­»äººâ€ã€‚</td></tr></table></div></td></tr></table></div></div>

#### ğŸ“¤ output data è¾“å‡ºæ•°æ®
<div class="sample-card" style="border:1px solid #ddd; padding:12px; margin:8px 0; border-radius:6px; background:#fafafa; box-shadow:0 1px 3px rgba(0,0,0,0.1);"><div class="sample-header" style="background:#f8f9fa; padding:4px 8px; margin-bottom:6px; border-radius:3px; font-size:0.9em; color:#666; border-left:3px solid #007acc;"><strong>Sample 1:</strong> empty</div><div class='meta' style='margin:6px 0;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__meta__</th></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´å‰ï¼Œæç›¸å¤·åäº”å²æˆ˜èƒœè¥¿åŸŸå¤©é­”æˆä¸ºå¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ï¼Œåä¸ƒå²å»ºç«‹å››é¡¾é—¨ï¼ŒäºŒåå²é—®é¼æ­¦æ—ç›Ÿä¸»ï¼Œæˆä¸ºä¼ å¥‡äººç‰©ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>æœ‰äººè§†æç›¸å¤·ä¸ºä¸­åŸæ­¦æ—çš„å¸Œæœ›ï¼Œä½†ä¹Ÿæœ‰äººä»¥æˆ˜èƒœä»–ä¸ºç›®æ ‡ï¼ŒåŒ…æ‹¬é­”æ•™é‡‘é¸³ç›Ÿç›Ÿä¸»ç¬›é£å£°ã€‚ç¬›é£å£°è®¾è®¡åŠ å®³æç›¸å¤·çš„å¸ˆå…„å•å­¤åˆ€ï¼Œå¼•å¾—æç›¸å¤·ä¸ä¹‹ä¸€æˆ˜ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åœ¨ä¸œæµ·çš„ä¸€è‰˜èˆ¹ä¸Šï¼Œæç›¸å¤·ç‹¬è‡ªä¸€äººå¯¹æŠ—é‡‘é¸³ç›Ÿçš„é«˜æ‰‹ï¼Œæœ€ç»ˆå‡»è´¥äº†å¤§éƒ¨åˆ†æ•Œäººã€‚ç¬›é£å£°çªç„¶å‡ºç°ï¼Œä¸¤äººæ¿€æˆ˜ï¼Œæç›¸å¤·åœ¨æˆ˜æ–—ä¸­ä¸­æ¯’ï¼Œæœ€ç»ˆè¢«ç¬›é£å£°é‡ä¼¤ï¼Œèˆ¹åªçˆ†ç‚¸ï¼Œæç›¸å¤·æ²‰å…¥å¤§æµ·ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åå¹´åï¼Œæè²èŠ±åœ¨ä¸€ä¸ªå¯’é…¸çš„è²èŠ±æ¥¼å†…é†’æ¥ï¼Œè¡¨ç°å‡ºä¸æç›¸å¤·æˆªç„¶ä¸åŒçš„æ€§æ ¼ã€‚ä»–ä»¥ç¥åŒ»çš„èº«ä»½åœ¨å°é•‡ä¸Šè¡ŒåŒ»ï¼Œä½†ç”Ÿæ´»è´«å›°ã€‚</td></tr></table></div></td></tr><tr><td colspan='2' style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; border-bottom:1px solid #e3e3e3;'><div style='margin:2px 0 6px 0; padding-left:8px;'><table class='meta-table' style='border-collapse:collapse; width:100%; border:1px solid #e3e3e3;'><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:36px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>event_description</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>å°é•‡ä¸Šçš„çš®å½±æˆæ‘Šè®²è¿°æç›¸å¤·å’Œç¬›é£å£°çš„æ•…äº‹ï¼Œå­©å­ä»¬äº‰è®ºè°èµ¢äº†ã€‚é£ç«å ‚ç®¡äº‹å¸¦ç€äººæ¥æ‰¾æè²èŠ±ï¼Œè¦æ±‚ä»–æ•‘æ²»ä¸€ä¸ªâ€œæ­»äººâ€ã€‚</td></tr></table></div></td></tr><tr><th colspan='2' style='text-align:left; vertical-align:top; padding:6px 8px; font-weight:600; border-bottom:1px solid #e3e3e3;'>__dj__batch_meta__</th></tr><tr><td style='text-align:left; vertical-align:top; padding:4px 8px; padding-left:22px; font-weight:500; color:#444; border-bottom:1px solid #e3e3e3; white-space:nowrap;'>entity_attribute</td><td style='text-align:left; vertical-align:top; padding:4px 6px; padding-left:4px; border-bottom:1px solid #e3e3e3;'>åŸåæç›¸å¤·ï¼Œæ›¾æ˜¯å¤©ä¸‹ç¬¬ä¸€é«˜æ‰‹ã€æ­¦æ—ç›Ÿä¸»ï¼ŒååŒ–åæè²èŠ±ï¼Œä»¥ç¥åŒ»èº«ä»½éšå±…ã€‚</td></tr></table></div></div>

#### âœ¨ explanation è§£é‡Š
This example shows how to limit the number of words in the summary. The operator generates a concise summary of the character 'æè²èŠ±' with a word limit of 20. The output is a brief summary that captures the essence of 'æè²èŠ±'â€™s background and experiences. The summary is stored under the 'entity_attribute' key in the batch metadata.
æ­¤ç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•é™åˆ¶æ‘˜è¦ä¸­çš„å­—æ•°ã€‚ç®—å­ç”Ÿæˆä¸€ä¸ªå…³äºè§’è‰²'æè²èŠ±'çš„ç®€çŸ­æ‘˜è¦ï¼Œå­—æ•°é™åˆ¶ä¸º20ã€‚è¾“å‡ºæ˜¯ä¸€ä¸ªç®€æ´çš„æ‘˜è¦ï¼Œæ¦‚æ‹¬äº†'æè²èŠ±'çš„èƒŒæ™¯å’Œç»å†ã€‚è¯¥æ‘˜è¦å­˜å‚¨åœ¨æ‰¹æ¬¡å…ƒæ•°æ®çš„'entity_attribute'é”®ä¸‹ã€‚


## ğŸ”— related links ç›¸å…³é“¾æ¥
- [source code æºä»£ç ](../../../data_juicer/ops/aggregator/entity_attribute_aggregator.py)
- [unit test å•å…ƒæµ‹è¯•](../../../tests/ops/aggregator/test_entity_attribute_aggregator.py)
- [Return operator list è¿”å›ç®—å­åˆ—è¡¨](../../Operators.md)